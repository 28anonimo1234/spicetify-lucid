(async () => { while (!Spicetify.React || !Spicetify.ReactDOM) { await new Promise((resolve) => setTimeout(resolve, 10));}"use strict";var Lucid=(()=>{var Oo=Object.defineProperty,Ro=Object.defineProperties;var Ao=Object.getOwnPropertyDescriptors;var ye=Object.getOwnPropertySymbols;var ut=Object.prototype.hasOwnProperty,dt=Object.prototype.propertyIsEnumerable;var Ge=(t,o,e)=>o in t?Oo(t,o,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[o]=e,l=(t,o)=>{for(var e in o||(o={}))ut.call(o,e)&&Ge(t,e,o[e]);if(ye)for(var e of ye(o))dt.call(o,e)&&Ge(t,e,o[e]);return t},u=(t,o)=>Ro(t,Ao(o));var mt=(t,o)=>{var e={};for(var i in t)ut.call(t,i)&&o.indexOf(i)<0&&(e[i]=t[i]);if(t!=null&&ye)for(var i of ye(t))o.indexOf(i)<0&&dt.call(t,i)&&(e[i]=t[i]);return e};var c=(t,o,e)=>Ge(t,typeof o!="symbol"?o+"":o,e);var M={defaultMerge:Symbol("deepmerge-ts: default merge"),skip:Symbol("deepmerge-ts: skip")},Gr={defaultMerge:M.defaultMerge};function Fo(t,o){return o}function Ho(t,o){return t.filter(e=>e!==void 0)}var gt;(function(t){t[t.NOT=0]="NOT",t[t.RECORD=1]="RECORD",t[t.ARRAY=2]="ARRAY",t[t.SET=3]="SET",t[t.MAP=4]="MAP",t[t.OTHER=5]="OTHER"})(gt||(gt={}));function ht(t){return typeof t!="object"||t===null?0:Array.isArray(t)?2:Vo(t)?1:t instanceof Set?3:t instanceof Map?4:5}function Uo(t){let o=new Set;for(let e of t)for(let i of[...Object.keys(e),...Object.getOwnPropertySymbols(e)])o.add(i);return o}function $o(t,o){return typeof t=="object"&&Object.prototype.propertyIsEnumerable.call(t,o)}function bt(t){var i;let o=0,e=(i=t[0])==null?void 0:i[Symbol.iterator]();return{[Symbol.iterator](){return{next(){var r;do{if(e===void 0)return{done:!0,value:void 0};let a=e.next();if(a.done===!0){o+=1,e=(r=t[o])==null?void 0:r[Symbol.iterator]();continue}return{done:!1,value:a.value}}while(!0)}}}}}var ft=["[object Object]","[object Module]"];function Vo(t){if(!ft.includes(Object.prototype.toString.call(t)))return!1;let{constructor:o}=t;if(o===void 0)return!0;let e=o.prototype;return!(e===null||typeof e!="object"||!ft.includes(Object.prototype.toString.call(e))||!e.hasOwnProperty("isPrototypeOf"))}function No(t,o,e){let i={};for(let r of Uo(t)){let a=[];for(let d of t)$o(d,r)&&a.push(d[r]);if(a.length===0)continue;let s=o.metaDataUpdater(e,{key:r,parents:t}),p=yt(a,o,s);p!==M.skip&&(r==="__proto__"?Object.defineProperty(i,r,{value:p,configurable:!0,enumerable:!0,writable:!0}):i[r]=p)}return i}function Do(t){return t.flat()}function Go(t){return new Set(bt(t))}function zo(t){return new Map(bt(t))}function Ko(t){return t.at(-1)}var ve={mergeRecords:No,mergeArrays:Do,mergeSets:Go,mergeMaps:zo,mergeOthers:Ko};function Se(...t){return Wo({})(...t)}function Wo(t,o){let e=qo(t,i);function i(...r){return yt(r,e,o)}return i}function qo(t,o){var e,i,r;return{defaultMergeFunctions:ve,mergeFunctions:l(l({},ve),Object.fromEntries(Object.entries(t).filter(([a,s])=>Object.hasOwn(ve,a)).map(([a,s])=>s===!1?[a,ve.mergeOthers]:[a,s]))),metaDataUpdater:(e=t.metaDataUpdater)!=null?e:Fo,deepmerge:o,useImplicitDefaultMerging:(i=t.enableImplicitDefaultMerging)!=null?i:!1,filterValues:t.filterValues===!1?void 0:(r=t.filterValues)!=null?r:Ho,actions:M}}function yt(t,o,e){var a,s;let i=(s=(a=o.filterValues)==null?void 0:a.call(o,t,e))!=null?s:t;if(i.length===0)return;if(i.length===1)return ze(i,o,e);let r=ht(i[0]);if(r!==0&&r!==5){for(let p=1;p<i.length;p++)if(ht(i[p])!==r)return ze(i,o,e)}switch(r){case 1:return Yo(i,o,e);case 2:return Zo(i,o,e);case 3:return Xo(i,o,e);case 4:return Jo(i,o,e);default:return ze(i,o,e)}}function Yo(t,o,e){let i=o.mergeFunctions.mergeRecords(t,o,e);return i===M.defaultMerge||o.useImplicitDefaultMerging&&i===void 0&&o.mergeFunctions.mergeRecords!==o.defaultMergeFunctions.mergeRecords?o.defaultMergeFunctions.mergeRecords(t,o,e):i}function Zo(t,o,e){let i=o.mergeFunctions.mergeArrays(t,o,e);return i===M.defaultMerge||o.useImplicitDefaultMerging&&i===void 0&&o.mergeFunctions.mergeArrays!==o.defaultMergeFunctions.mergeArrays?o.defaultMergeFunctions.mergeArrays(t):i}function Xo(t,o,e){let i=o.mergeFunctions.mergeSets(t,o,e);return i===M.defaultMerge||o.useImplicitDefaultMerging&&i===void 0&&o.mergeFunctions.mergeSets!==o.defaultMergeFunctions.mergeSets?o.defaultMergeFunctions.mergeSets(t):i}function Jo(t,o,e){let i=o.mergeFunctions.mergeMaps(t,o,e);return i===M.defaultMerge||o.useImplicitDefaultMerging&&i===void 0&&o.mergeFunctions.mergeMaps!==o.defaultMergeFunctions.mergeMaps?o.defaultMergeFunctions.mergeMaps(t):i}function ze(t,o,e){let i=o.mergeFunctions.mergeOthers(t,o,e);return i===M.defaultMerge||o.useImplicitDefaultMerging&&i===void 0&&o.mergeFunctions.mergeOthers!==o.defaultMergeFunctions.mergeOthers?o.defaultMergeFunctions.mergeOthers(t):i}function vt(t,o){if(!o)return t;let e=o.split(/[.\[\]'"]/).filter(Boolean),i=t;for(let r of e)if(i&&typeof i=="object"&&r in i)i=i[r];else return;return i}var Ke=class{constructor(o,e={}){c(this,"state");c(this,"subscribers",[]);c(this,"options");if(this.options=l({persist:!1,localStorageKey:"storeState"},e),this.options.persist&&this.options.localStorageKey){let i=localStorage.getItem(this.options.localStorageKey);if(!i){this.state=o;return}try{let r=JSON.parse(i);this.state=Se(o,r)}catch(r){console.error("Error parsing stored state from localStorage:",r),this.state=o}}else this.state=o}getState(){return this.state}setState(o,e){let i=l({},this.state),r=o(this.state,e);this.updateStateAndNotify(r,i)}updateStateAndNotify(o,e){o!==this.state&&(this.state=o,this.notifySubscribers(e),this.options.persist&&this.persist())}subscribe(o,e){let i={subscriber:o,path:e};return this.subscribers.push(i),()=>{this.subscribers=this.subscribers.filter(r=>r!==i)}}notifySubscribers(o){for(let e of this.subscribers){let{subscriber:i,path:r}=e,a=vt(o,r),s=vt(this.state,r);if(JSON.stringify(a)!==JSON.stringify(s)){let p=performance.now();try{i(this.state)}catch(n){console.error(`Subscriber at path "${r}" threw an error:`,n)}let d=performance.now()-p;d>10&&console.warn(`Slow subscriber at path "${r}" took ${d.toFixed(2)}ms. Subscriber: ${i}`)}}}persist(){try{if(this.options.localStorageKey)localStorage.setItem(this.options.localStorageKey,JSON.stringify(this.state));else throw new Error("localStorage key not found!")}catch(o){console.error("Error saving state to localStorage:",o)}}},z=Ke;function f(t){return t!==null&&typeof t=="object"}function _e(t){return f(t)&&(t.blur===void 0||typeof t.blur=="number")&&(t.brightness===void 0||typeof t.brightness=="number")&&(t.contrast===void 0||typeof t.contrast=="number")&&(t.grayscale===void 0||typeof t.grayscale=="string")&&(t.hueRotate===void 0||typeof t.hueRotate=="string")&&(t.invert===void 0||typeof t.invert=="string")&&(t.opacity===void 0||typeof t.opacity=="number")&&(t.saturate===void 0||typeof t.saturate=="number")&&(t.sepia===void 0||typeof t.sepia=="string")}function Z(t){return f(t)&&typeof t.hex=="string"&&typeof t.alpha=="number"}function Qo(t){return f(t)&&typeof t.url=="string"}function jo(t){return f(t)&&Array.isArray(t.selectedIds)&&t.selectedIds.every(o=>typeof o=="number")&&f(t.slideshow)&&typeof t.slideshow.isSlideshow=="boolean"&&typeof t.slideshow.timeDelay=="number"}function er(t){return!f(t)||typeof t.isCustom!="boolean"||t.type!=="url"&&t.type!=="local"||!f(t.options)?!1:t.type==="url"?Qo(t.options.url):t.type==="local"?jo(t.options.local):!1}function tr(t){return f(t)&&er(t.customImage)&&(t.filter===void 0||_e(t.filter))}function or(t){return f(t)&&Z(t.color)}function rr(t){return f(t)&&_e(t.filter)}function ir(t){return f(t)&&tr(t.static)&&or(t.solid)&&rr(t.animated)}function nr(t){return f(t)&&typeof t.mode=="string"&&(t.mode==="static"||t.mode==="solid"||t.mode==="animated")&&ir(t.options)}function ar(t){return f(t)&&typeof t.thickness=="number"&&Z(t.color)&&typeof t.style=="string"}function sr(t){return f(t)&&(t.mode==="compact"||t.mode==="normal")&&(t.position==="bottom left"||t.position==="bottom right"||t.position==="top left"||t.position==="top right")&&typeof t.blur=="number"&&typeof t.size=="number"&&typeof t.isCustomBg=="boolean"&&Z(t.color)}function lr(t){return f(t)?["normal","expanded","npv"].every(e=>{let i=t[e];return f(i)&&typeof i.isScaling=="boolean"&&typeof i.isScroll=="boolean"&&(i.filter===null||_e(i.filter))}):!1}function cr(t){return f(t)&&(t.type==="npv"||t.type==="normal")&&lr(t.options)}function pr(t){return f(t)&&typeof t.panelGap=="number"&&typeof t.hideHomeHeader=="boolean"&&typeof t.style=="string"&&cr(t.umv)}function ur(t){return f(t)&&typeof t.isDynamic=="boolean"&&typeof t.isCustom=="boolean"&&typeof t.isTonal=="boolean"&&Z(t.customColor)}function dr(t){return f(t)&&_e(t.backdropFilter)&&typeof t.height=="number"&&typeof t.paddingX=="number"&&Z(t.bgColor)&&typeof t.bgOpacity=="number"&&typeof t.borderRadius=="number"}function mr(t){return f(t)?["compact","normal"].every(e=>dr(t[e])):!1}function gr(t){return f(t)&&(t.type==="compact"||t.type==="normal")&&mr(t.options)&&typeof t.isFloating=="boolean"&&typeof t.hideIcons=="boolean"}function hr(t){return f(t)&&(t.type==="default"||t.type==="starry"||t.type==="none")}function Ee(t){return f(t)&&(t.position==="context-menu"||t.position==="nav")&&nr(t.background)&&ar(t.border)&&pr(t.pages)&&ur(t.color)&&f(t.control)&&typeof t.control.height=="number"&&f(t.font)&&typeof t.font.fontFamily=="string"&&(typeof t.font.fontUrl=="string"||t.font.fontUrl===null)&&typeof t.font.isGoogleFonts=="boolean"&&hr(t.grains)&&gr(t.playbar)&&sr(t.rightSidebar)}var X="https://raw.githubusercontent.com/sanoojes/Spicetify-Lucid/refs/heads/main",J="https://cdn.jsdelivr.net/gh/sanoojes/Spicetify-Lucid@main",St,_t,Q=(_t=(St=window==null?void 0:window.lucid)==null?void 0:St.version)!=null?_t:"2.0.0",j="lucid-guided-tour",Et=[`${X}/src/workers/getColor.js`,`${J}/src/workers/getColor.js`],we="LUCID_COLOR_SCRIPT_CACHE",wt="#1bc858",Ce="LUCID_GUIDE_SCRIPT_CACHE",Ct=[`${X}/src/guidedTour.js`,`${J}/src/guidedTour.js`],kt="lucid-theme-settings",D="lucid-current-version",xt=[`${X}/changelog.json`,`${J}/changelog.json`],ke="lucid-changelog-data",xe="LucidIDB",It=[`${X}/src/icons.css`,`${J}/src/icons.css`,`${X}/styles/icons.css`,`${J}/styles/icons.css`],Tt="LUCID_CSS_SCRIPT_CACHE",Lt="lucid-icons",We={showChangelog:!0,position:"nav",background:{mode:"static",options:{static:{isCustomImage:!1,filter:{blur:32,brightness:60,saturate:150}},solid:{color:{hex:"#1a211c",alpha:100}},animated:{filter:{blur:32,brightness:60,saturate:150}}}},color:{customColor:{hex:"#00ffa1",alpha:100},isTonal:!0,isCustom:!1,isDynamic:!1,extractorOptions:{pixels:36e4,distance:.1,hueDistance:.2,lightnessDistance:.2,saturationDistance:.2}},pages:{panelGap:8,hideHomeHeader:!1,style:"card",imageStyle:"default",umv:{type:"normal",options:{expanded:{isScroll:!1,isScaling:!0,filter:{blur:0}},custom:{url:"https://picsum.photos/1920/1080?random",isScroll:!1,isScaling:!0,filter:{blur:8}},normal:{isScroll:!1,isScaling:!0,filter:{blur:8}},npv:{isScroll:!1,isScaling:!0,filter:{blur:8}}}}},border:{thickness:1,color:{hex:"#454545",alpha:50},style:"solid"},control:{height:40},font:{fontFamily:"Poppins",fontUrl:"https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap",isGoogleFonts:!0},grains:{type:"starry"},rightSidebar:{isCustomBg:!1,mode:"normal",position:"bottom right",blur:16,size:240,color:{hex:"#1a211c",alpha:50}},playbar:{type:"normal",hideIcons:!0,options:{normal:{height:80,paddingX:8,bgColor:{hex:"",alpha:50},bgOpacity:100,imageRadius:8,borderRadius:8,backdropFilter:{blur:32,saturate:150,brightness:60}},compact:{height:64,paddingX:8,bgColor:{hex:"",alpha:50},bgOpacity:100,imageRadius:8,borderRadius:8,backdropFilter:{blur:32,saturate:150,brightness:60}}},isFloating:!0},customImage:{type:"url",options:{url:{data:"https://picsum.photos/1920/1080?random"},local:null}}};var y=(t,o=!1,e)=>{for(;!Spicetify.showNotification;)setTimeout(y,500);console.debug(`Notification: ${t} (Error: ${o}, Timeout: ${e})`),Spicetify.showNotification(t,o,e)};var qe=class extends z{constructor(o=We,e={persist:!0,localStorageKey:kt}){super(o,e)}setChangelog(o){this.setState(e=>u(l({},e),{showChangelog:o}))}setPages(o){this.setState(e=>u(l({},e),{pages:l(l({},e.pages),o)}))}setUMV(o){this.setState(e=>u(l({},e),{pages:u(l({},e.pages),{umv:l(l({},e.pages.umv),o)})}))}setUMVOption(o,e){this.setState(i=>u(l({},i),{pages:u(l({},i.pages),{umv:u(l({},i.pages.umv),{options:u(l({},i.pages.umv.options),{[o]:l(l({},i.pages.umv.options[o]),e)})})})}))}setUMVFilter(o,e){this.setState(i=>u(l({},i),{pages:u(l({},i.pages),{umv:u(l({},i.pages.umv),{options:u(l({},i.pages.umv.options),{[o]:u(l({},i.pages.umv.options[o]),{filter:l(l({},i.pages.umv.options[o].filter),e)})})})})}))}setCustomImageType(o){this.setState(e=>u(l({},e),{customImage:u(l({},e.customImage),{type:o})}))}setCustomImageOptions(o,e){this.setState(i=>u(l({},i),{customImage:u(l({},i.customImage),{options:u(l({},i.customImage.options),{[o]:l(l({},i.customImage.options[o]),e)})})}))}setPosition(o){this.setState(e=>u(l({},e),{position:o}))}setBackgroundMode(o){this.setState(e=>u(l({},e),{background:u(l({},e.background),{mode:o})}))}setStaticBackgroundOptions(o){this.setState(e=>u(l({},e),{background:u(l({},e.background),{options:u(l({},e.background.options),{static:l(l({},e.background.options.static),o)})})}))}setStaticBackgroundFilter(o){this.setState(e=>u(l({},e),{background:u(l({},e.background),{options:u(l({},e.background.options),{static:u(l({},e.background.options.static),{filter:l(l({},e.background.options.static.filter),o)})})})}))}setAnimatedBackgroundFilter(o){this.setState(e=>u(l({},e),{background:u(l({},e.background),{options:u(l({},e.background.options),{animated:u(l({},e.background.options.animated),{filter:l(l({},e.background.options.animated.filter),o)})})})}))}setStaticBgFilter(o){this.setState(e=>u(l({},e),{background:u(l({},e.background),{options:u(l({},e.background.options),{static:u(l({},e.background.options.static),{filter:l(l({},e.background.options.static.filter),o)})})})}))}setSolidBackgroundColor(o){this.setState(e=>u(l({},e),{background:u(l({},e.background),{options:u(l({},e.background.options),{solid:u(l({},e.background.options.solid),{color:l(l({},e.background.options.solid.color),o)})})})}))}setAnimatedBackgroundOptions(o){this.setState(e=>u(l({},e),{background:u(l({},e.background),{options:u(l({},e.background.options),{animated:o})})}))}setBorder(o){this.setState(e=>u(l({},e),{border:l(l({},e.border),o)}))}setBorderColor(o){this.setState(e=>u(l({},e),{border:u(l({},e.border),{color:l(l({},e.border.color),o)})}))}setControlHeight(o){this.setState(e=>u(l({},e),{control:u(l({},e.control),{height:o})}))}setFont(o){this.setState(e=>u(l({},e),{font:l(l({},e.font),o)}))}setGrains(o){this.setState(e=>u(l({},e),{grains:l(l({},e.grains),o)}))}setRightSidebar(o){this.setState(e=>u(l({},e),{rightSidebar:l(l({},e.rightSidebar),o)}))}setColor(o){this.setState(e=>u(l({},e),{color:l(l({},e.color),o)}))}setColorExtractorOptions(o){this.setState(e=>u(l({},e),{color:u(l({},e.color),{extractorOptions:l(l({},e.color.extractorOptions),o)})}))}setPageStyle(o){this.setState(e=>u(l({},e),{pages:u(l({},e.pages),{style:o})}))}setPageImageStyle(o){this.setState(e=>u(l({},e),{pages:u(l({},e.pages),{imageStyle:o})}))}setPlaybar(o){this.setState(e=>u(l({},e),{playbar:l(l({},e.playbar),o)}))}setPlaybarOptions(o,e){this.setState(i=>u(l({},i),{playbar:u(l({},i.playbar),{options:u(l({},i.playbar.options),{[o]:l(l({},i.playbar.options[o]),e)})})}))}setPlaybarFilter(o,e){this.setState(i=>u(l({},i),{playbar:u(l({},i.playbar),{options:u(l({},i.playbar.options),{[o]:u(l({},i.playbar.options[o]),{backdropFilter:l(l({},i.playbar.options[o].backdropFilter),e)})})})}))}setRightSidebarColor(o){this.setState(e=>u(l({},e),{rightSidebar:u(l({},e.rightSidebar),{color:l(l({},e.rightSidebar.color),o)})}))}setGrainsType(o){this.setState(e=>u(l({},e),{grains:u(l({},e.grains),{type:o})}))}setDynamicColor(o){this.setState(e=>u(l({},e),{color:u(l({},e.color),{isDynamic:o})}))}setIsCustomColor(o){this.setState(e=>u(l({},e),{color:u(l({},e.color),{isCustom:o})}))}setCustomColor(o){this.setState(e=>u(l({},e),{color:u(l({},e.color),{customColor:l(l({},e.color.customColor),o)})}))}setTonalColor(o){this.setState(e=>u(l({},e),{color:u(l({},e.color),{isTonal:o})}))}resetState(){try{this.setState(()=>We),localStorage.removeItem(j),localStorage.removeItem(Ce),localStorage.removeItem(we),localStorage.removeItem(ke),localStorage.removeItem(D),window.location.reload()}catch(o){y("Error reseting settings.",!0,5e3),console.error("Error reseting settings.",o)}}exportSettings(){let o=Ye.getState();return JSON.stringify(o,null,0)}importSettings(o){try{let e=JSON.parse(o);Ee(e)?(Ye.setState(i=>Se(i,e)),y("Settings imported successfully!",!1,5e3)):(console.error("Invalid settings format."),y("Import failed: Invalid settings format.",!0,5e3))}catch(e){console.error("Error importing settings:",e),y("Import failed: Unable to parse settings JSON.",!0,5e3)}}},Ye=new qe,g=Ye;function m(t,o){let e=document.createElement(t);if(!o)return e;if(o.attributes)for(let[p,d]of Object.entries(o.attributes))d?e.setAttribute(p,d):e.removeAttribute(p);o.style&&Object.assign(e.style,o.style);let s=o,{style:i,attributes:r}=s,a=mt(s,["style","attributes"]);return Object.assign(e,a),e}var Bt=t=>{let o=document.getElementById(t);return o||(o=document.createElement(t),document.body.appendChild(o)),o},S=t=>{let o=document.querySelector(`#style-${t}`);return o||(o=m("style",{id:`style-${t}`}),document.head.appendChild(o)),o};var Mt=()=>{let t=document.querySelector(".Root__right-sidebar .main-nowPlayingView-nowPlayingWidget .main-image-image");return(t==null?void 0:t.src)||""},Pt=async()=>{var i,r;for(;!((i=Spicetify.Player)!=null&&i.data);)await new Promise(a=>setTimeout(a,50));let t=(r=Spicetify.Player.data)==null?void 0:r.item;return!t||!t.metadata?(console.error("No item or metadata found in Spicetify Player data."),""):[t.metadata.image_xlarge_url,t.metadata.image_large_url,t.metadata.image_url,t.metadata.image_small_url].find(a=>a)||Mt()||Mt()},Ot=async(t,o,e=3)=>{for(let i=0;i<=e;i++)try{return await Spicetify.GraphQL.Request(u(l({},t),{operation:"query",value:null}),o)}catch(r){if(r instanceof Error&&r.message.includes("DUPLICATE_REQUEST_ERROR")&&i<e){console.warn(`Retrying ${t.name}... (${i+1}/${e})`),await new Promise(a=>setTimeout(a,1e3));continue}throw console.error(`Error in ${t.name}:`,r),r}return null},fr=t=>Ot({name:"getAlbum",sha256Hash:"469874edcad37b7a379d4f22f0083a49ea3d6ae097916120d9bbe3e36ca79e9d"},{uri:t,locale:null,offset:0,limit:50}),br=t=>Ot({name:"queryArtistOverview",sha256Hash:"35648a112beb1794e39ab931365f6ae4a8d45e65396d641eeda94e4003d41497"},{uri:t,includePrerelease:!0,locale:null}),yr=t=>{let o=t.match(/\/(playlist|artist|album|user|show)\/([^/]+)/);if(!o)return console.warn("No valid type or ID found in pathname:",t),null;let[,e,i]=o;return`spotify:${e}:${i}`},Rt=async t=>{var r,a,s,p,d,n,h,b,L,be,Y,ct,pt;let o=yr(t);if(!o)return null;let[,e,i]=o.split(":");try{switch(e){case"playlist":case"show":return((r=(await Spicetify.Platform.PlaylistAPI.getMetadata(o)).images[0])==null?void 0:r.url)||null;case"artist":{let _=await br(o),E=(s=(a=_==null?void 0:_.data)==null?void 0:a.artistUnion)==null?void 0:s.visuals;return((d=(p=E==null?void 0:E.headerImage)==null?void 0:p.sources[0])==null?void 0:d.url)||((h=(n=E==null?void 0:E.avatarImage)==null?void 0:n.sources[0])==null?void 0:h.url)||null}case"album":{let _=await fr(o),E=(be=(L=(b=_==null?void 0:_.data)==null?void 0:b.albumUnion)==null?void 0:L.coverArt)==null?void 0:be.sources;return((Y=E==null?void 0:E[2])==null?void 0:Y.url)||((ct=E==null?void 0:E[0])==null?void 0:ct.url)||null}case"user":{let _=await Spicetify.Platform.RequestBuilder.build().withHost("https://spclient.wg.spotify.com/user-profile-view/v3").withPath(`/profile/${i}`).send();return((pt=_==null?void 0:_.body)==null?void 0:pt.image_url)||null}default:return null}}catch(_){return console.error(`Error fetching ${e} artwork:`,_),null}};function At(t){let o=t.match(/url\(["']?(.*?)["']?\)/);return o?o[1]:null}function P(t,o,e=100){let i=t.map(r=>document.querySelector(r));i.every(r=>r)?o(i):e>0&&setTimeout(P,300,t,o,--e)}var w=new z({url:null});async function Ft(){try{let t=await Pt();w.setState(()=>({url:t}))}catch(t){console.error("Error updating NPV state:",t),w.setState(()=>({url:null}))}}Ft();Spicetify.Player.addEventListener("songchange",Ft);var ee=class extends HTMLElement{constructor(e){super();c(this,"imgElement");c(this,"transitionDuration",.5);c(this,"filter","blur(0px)");c(this,"transitionTimingFunction","ease-in-out");e&&(this.imageSrc=e),Object.assign(this.style,{width:"100%",height:"100%",display:"block",willChange:"transform"}),this.imgElement=m("img",{className:"umv-img",style:{filter:this.filter,opacity:"1",transition:`opacity ${this.transitionDuration}s ${this.transitionTimingFunction}`,willChange:"opacity, transform"}}),this.append(this.imgElement)}setFilter(e){this.style.filter=e}set imageSrc(e){if(!e){this.style.opacity="0";return}if(this.style.opacity="1",e.trim()===""||this.imgElement.src===e)return;let i=new Image;i.onload=()=>{this._performTransition(e)},i.onerror=()=>{console.error("Failed to load image:",e)},i.src=e}_performTransition(e){if(this.imgElement.src===e)return;let i=this.imgElement,r=m("img",{className:"umv-img",style:{width:"100%",height:"100%",objectPosition:"center",position:"absolute",top:"0",left:"0",objectFit:"cover",filter:this.filter,opacity:"0",transform:"scale(1.05)",transition:`opacity ${this.transitionDuration}s ${this.transitionTimingFunction}, transform ${this.transitionDuration}s ${this.transitionTimingFunction}`,willChange:"opacity, transform"}});r.src=e,this.appendChild(r),requestAnimationFrame(()=>{r.style.opacity="1",r.style.transform="scale(1)"}),i.style.opacity="0",i.style.transform="scale(0.95)",setTimeout(()=>{this.imgElement.remove(),this.imgElement=r},this.transitionDuration*1e3)}hideImage(){this.imgElement.style.opacity="0"}unhideImage(){this.imgElement.style.opacity="1"}};customElements.define("umv-image",ee);var vr=".Root__main-view .os-viewport, .Root__main-view .main-view-container > .main-view-container__scroll-node:not([data-overlayscrollbars-initialize]), .Root__main-view .main-view-container__scroll-node > [data-overlayscrollbars-viewport]",Sr="umv-overrides",_r=".Root__main-view",Ht=".under-main-view",Er=".main-entityHeader-gradient, .XUwMufC5NCgIyRMyGXLD",wr=`
  .under-main-view { display: none; }
  umv-container {
    width: 100%;
    display: block;
    position: absolute;
    inset: 0px;
    height: 50cqh;
    -webkit-mask-image: linear-gradient(rgb(0, 0, 0) 40cqh, rgba(0, 0, 0, 0) 100%);
    mask-image: linear-gradient(rgb(0, 0, 0) 40cqh, rgba(0, 0, 0, 0) 100%);
    transform: translate3d(0px, 0px, 0px) scale(1);
    will-change: transform;
  }
  umv-container[source="expanded"] {
    height: calc(100cqh - var(--umv-offset, 526px));
    transform: translate3d(0px, 0px, 0px) scale(1);
    -webkit-mask-image: none;
    mask-image: none;
  }
  .main-entityHeader-container.main-entityHeader-withBackgroundImage{
    height: calc(100cqh - var(--umv-offset) - 1rem);
  }
  body[npb-is-floating] .main-entityHeader-container.main-entityHeader-withBackgroundImage{
    height: calc(100cqh - var(--umv-offset));
  }
  .main-entityHeader-container{ height: 40cqh; }
  .main-entityHeader-backgroundColor,.main-actionBarBackground-background { background: none !important;}
  .playlist-playlist-playlistContent,.EmeHQXR87mUskYK6xEde { background-color: rgba(var(--clr-surface-1-rgb),.5) !important; }
`,te=class extends HTMLElement{constructor(){super();c(this,"umvImage");c(this,"scrollElem");c(this,"mainViewElement");c(this,"_source");c(this,"_imageUrl");c(this,"_settings");c(this,"_isNpv",!1);c(this,"isArtist",!1);c(this,"options");c(this,"pageUrl");c(this,"umvArtUrl");c(this,"pageArtUrl");c(this,"unlistenHistory");c(this,"unobserveUMV");c(this,"unsubscribeNPV");let e=S(Sr);e.textContent=wr,this.mainViewElement=null,this.umvImage=new ee,this.append(this.umvImage),this._source="normal",this._imageUrl=null,this.pageUrl="",this._settings=null,this.settings=g.getState().pages.umv,g.subscribe(i=>{this.settings=i.pages.umv},"pages.umv"),this.scrollElem=null,this.umvArtUrl=null,this.pageArtUrl=null,this.unsubscribeNPV=null}connectedCallback(){var e,i,r;P([_r],([a])=>{this.mainViewElement=a}),P([vr],([a])=>{this.scrollElem=a,this._scrollEventCb=this._scrollEventCb.bind(this),this._listenScrollChange()}),this._listenForUMVChange(),this.updateImageUrlFromPage(((r=(i=(e=Spicetify==null?void 0:Spicetify.Platform)==null?void 0:e.History)==null?void 0:i.location)==null?void 0:r.pathname)||"/")}disconnectedCallback(){this.scrollElem&&this.scrollElem.removeEventListener("scroll",this._scrollEventCb),this.unobserveUMV&&this.unobserveUMV(),this.unlistenHistory&&this.unlistenHistory(),this.unsubscribeNPV&&(this.unsubscribeNPV(),this.unsubscribeNPV=null)}set settings(e){this._settings=e,this.options=e.options[this._source],e.type==="npv"?this.isNpv=!0:this.isNpv=!1,this._scrollEventCb()}get settings(){var e;return(e=this._settings)!=null?e:g.getState().pages.umv}set isNpv(e){var i;if(this._isNpv=e,!e){(i=this.unsubscribeNPV)==null||i.call(this),this.unsubscribeNPV=null,this._updateImageBasedOnUrls();return}this._updateImageBasedOnUrls(),this.unsubscribeNPV=w.subscribe(()=>{this._updateImageBasedOnUrls()})}get isNpv(){return this._isNpv}set source(e){var i,r,a,s;this._source=e,this.setAttribute("source",e),this.isArtist=(r=(i=document.body.getAttribute("path"))==null?void 0:i.startsWith("artist",1))!=null?r:!1,this.options=this.settings.options[e],this.umvImage.setFilter(`blur(${(s=(a=this.settings.options[e].filter)==null?void 0:a.blur)!=null?s:0}px)`),this._scrollEventCb()}get source(){return this._source}set imageUrl(e){e!==this._imageUrl&&(this._imageUrl=e,this.umvImage.imageSrc=e)}async updateImageUrlFromPage(e){try{let i=null;if(i==="/"){this.pageArtUrl=null,this._updateImageBasedOnUrls();return}e&&(i=await Rt(e)),this.pageArtUrl=i,this._updateImageBasedOnUrls()}catch(i){console.error("Error updating image URL from page:",i),console.error("URL that caused the error:",e)}}_listenForPageChanges(){var e,i,r,a,s,p;this.pageUrl=((r=(i=(e=Spicetify==null?void 0:Spicetify.Platform)==null?void 0:e.History)==null?void 0:i.location)==null?void 0:r.pathname)||"/",this.unlistenHistory=(p=(s=(a=Spicetify.Platform)==null?void 0:a.History)==null?void 0:s.listen(d=>{d!=null&&d.pathname&&(this.pageUrl=d.pathname,this.umvArtUrl=null,this.pageArtUrl=null,this.updateImageUrlFromPage(d.pathname))}))!=null?p:()=>{console.error("Error unloading History listener. Spicetify.Platform?.History might be undefined.")}}_observeUMVImage(){let e=document.querySelector(Ht);if(!e)return console.warn(`Element "${Ht}" not found. UMV observation will not work.`),null;let i=()=>{let a=e.querySelector(Er);if(a){let s=At(a.style.backgroundImage);s?this.umvArtUrl=s:this.umvArtUrl=null,this._updateImageBasedOnUrls()}else this.umvArtUrl=null,this._updateImageBasedOnUrls()},r=new MutationObserver(i);r.observe(e,{childList:!0,subtree:!0}),this.unobserveUMV=()=>r.disconnect()}_listenForUMVChange(){this._listenForPageChanges(),this._observeUMVImage()}_scrollEventCb(e){var a,s,p,d,n,h;if(!this.settings)return;let i=(d=(p=(a=this.scrollElem)==null?void 0:a.scrollTop)!=null?p:(s=e==null?void 0:e.target)==null?void 0:s.scrollTop)!=null?d:0,r=this.settings.options[this.source];i<100&&document.body.style.setProperty("--changing-pixels",`${Math.random().toFixed(1)}px`),requestAnimationFrame(()=>{var Y;r.isScaling?this.umvImage.style.transform=`scale(${Math.round(Math.min(100+i/10,175))}%)`:this.umvImage.style.transform="scale(1)",r.isScroll?this.style.transform=`translate3d(0px,-${Math.min(i,window.innerHeight)}px,0px)`:this.style.transform="translate3d(0px,0px,0px)";let b=Math.min(i/10+(((Y=r.filter)==null?void 0:Y.blur)||0),this.isArtist?i/10:32),L=Math.max(60,100-i/window.innerHeight*40),be=Math.max(70,100-i/window.innerHeight*30);this.umvImage.setFilter(`blur(${b}px) brightness(${L}%) opacity(${be}%)`)}),i>window.innerHeight/5?(n=this.mainViewElement)==null||n.style.setProperty("--top-bar-opacity","1"):(h=this.mainViewElement)==null||h.style.setProperty("--top-bar-opacity","0")}_listenScrollChange(){this.scrollElem&&this.scrollElem.addEventListener("scroll",this._scrollEventCb)}_updateImageBasedOnUrls(){if(this.umvArtUrl){this.imageUrl=this.umvArtUrl,this.source="expanded";return}if(this.settings.type==="custom"){this.source="custom",this.imageUrl=this.settings.options.custom.url;return}if(this.isNpv&&this.pageArtUrl){this.imageUrl=w.getState().url,this.source="npv";return}if(this.pageArtUrl){this.imageUrl=this.pageArtUrl,this.source="normal";return}this.imageUrl=null,this.source="normal"}};customElements.define("umv-container",te);async function O(t,o,e=864e5){let i=JSON.parse(localStorage.getItem(o)||"null");if(i!=null&&i.script&&(!navigator.onLine||Date.now()-i.timestamp<e))return i.script;let r=null;for(let a of t)try{let s=await fetch(a);if(s.ok){r=await s.text();break}}catch(s){}if(!r){if(i!=null&&i.script)return i.script;throw new Error("Failed to fetch guide script from all sources.")}return localStorage.setItem(o,JSON.stringify({script:r,timestamp:Date.now()})),r}async function Cr(){let t=await O(It,Tt);S(Lt).textContent=t}var Ut=()=>{try{let o=function(a){return a.replace(/[{0}{1}«»”“]/g,"").trim()};var t=o;Cr();let e=(a,s=!1)=>s?o(i.get(a)):i.get(a),i=Spicetify.Locale;if(!i)return;let r={home:e("view.web-player-home"),browse:e("browse"),pause:e("pause"),play:e("play"),close:e("close"),openMiniPlayer:e("miniplayer.open"),createPlaylist:e("contextmenu.create-playlist"),createButton:e("web-player.your-library-x.create.button-label"),fullscreen:e("npv.full-screen"),closeBtn:e("close_button_action"),duration:e("sort.duration"),search:e("navbar.search"),queue:e("playback-control.queue"),searchPlaylist:e("playlist.search_in_playlist"),download:e("download.download"),copyTrackLink:e("context-menu.copy-track-link"),moreContext:e("more.label.context",!0),downloadContext:e("contextmenu.download"),friendActivity:e("buddy-feed.friend-activity"),whatsNew:e("web-player.whats-new-feed.button-label"),skipForward:e("playback-control.skip-forward"),skipBack:e("playback-control.skip-back"),disableShuffle:e("playback-control.disable-shuffle"),enableShuffle:e("playback-control.enable-shuffle"),disableShuffleGeneric:e("web-player.smart-shuffle.button-disable-shuffle-generic"),disableShuffleSpecific:e("web-player.smart-shuffle.button-disable-shuffle-specific",!0),enableShuffleGeneric:e("web-player.smart-shuffle.button-enable-shuffle-generic"),enableShuffleSpecific:e("web-player.smart-shuffle.button-enable-shuffle-specific",!0),enableSmartShuffleSpecific:e("web-player.smart-shuffle.button-enable-smart-shuffle-specific",!0),enableSmartShuffleGeneric:e("web-player.smart-shuffle.button-enable-smart-shuffle-generic"),enableRepeat:e("playback-control.enable-repeat"),enableRepeatOne:e("playback-control.enable-repeat-one"),disableRepeat:e("playback-control.disable-repeat")};S("lucid-icon-patch").innerHTML=`
 .main-yourLibraryX-navLink[aria-label="${r.home}"] path,
 button[aria-label="${r.home}"] path {
 	d: var(--home-icon-24);
 }
 .main-yourLibraryX-navLink[aria-label="${r.home}"].active path,
 .main-globalNav-navLinkActive[aria-label="${r.home}"] path {
 	d: var(--home-filled-icon-24);
 }
 .main-topBar-buddyFeed[aria-label*="${r.whatsNew}"] svg,
 .main-topBar-buddyFeed[aria-label*="${r.friendActivity}"] svg {
 	transform: scale(1.1);
 }
 
 .main-topBar-buddyFeed[aria-label*="${r.friendActivity}"] svg path {
 	d: var(--people-icon);
 }
 .main-topBar-buddyFeed[aria-label*="${r.friendActivity}"] .Svg-img-icon-small-textBase path {
 	d: var(--people-filled-icon);
 }
 .main-topBar-buddyFeed[aria-label*="${r.whatsNew}"] svg path {
 	d: var(--bell-icon);
 }
 .main-topBar-buddyFeed .Svg-img-icon-small[aria-label*="${r.whatsNew}"] .Svg-img-icon-small-textBase path {
 	d: var(--bell-filled-icon);
 }
 .b7r2WRiu5f9Q99qmyreh .M9l40ptEBXPm03dU3X1k,
 .player-controls__left button[aria-label*="${r.disableShuffle}"] path:nth-of-type(n+2),
 .player-controls__left button[aria-label*="${r.disableShuffleSpecific}"] path:nth-of-type(n+2),
 .player-controls__left button[aria-label*="${r.disableShuffleGeneric}"] path:nth-of-type(n+2),
 .player-controls__left button[aria-label*="${r.enableShuffle}"] path:nth-of-type(n+2),
 .player-controls__left button[aria-label*="${r.enableShuffleSpecific}"] path:nth-of-type(n+2),
 .player-controls__left button[aria-label*="${r.enableShuffleGeneric}"] path:nth-of-type(n+2),
 .player-controls__left button[aria-label*="${r.enableSmartShuffleGeneric}"] path:nth-of-type(n+2),
 .player-controls__left button[aria-label*="${r.enableSmartShuffleSpecific}"] path:nth-of-type(n+2),
 .Root__globalNav button[aria-label="${r.browse}"] path:nth-of-type(n + 2) {
 	display: none;
 }
 .Root__globalNav .main-globalNav-navLink.custom-navlink[aria-label*="Marketplace"] path {
 	d: var(--appstore-icon-24);
 	transform: scale(3) !important;
 }
 .Root__globalNav .main-globalNav-navLinkActive.custom-navlink[aria-label*="Marketplace"] path {
 	d: var(--appstore-filled-icon-24);
 }
 .Root__globalNav .IconContainer-leading:first-child svg path,
 .Root__globalNav .IconContainer-leading:has(button[aria-label*="${r.search}"]) div > svg path {
 	d: var(--search-icon-24);
 }
 .Root__globalNav button[aria-label="${r.browse}"] path {
 	d: var(--compass-icon-24);
 }
 .Root__globalNav button[aria-label="${r.browse}"].j4xi27AJ3oy5qZ8CGhhQ path {
 	d: var(--compass-filled-icon-24);
 }
 .player-controls__buttons .player-controls__left button[data-testid="control-button-skip-back"] path,
 .player-controls__buttons .player-controls__left button[aria-label*="${r.skipBack}"] path {
   fill: var(--clr-on-surface);
   d: var(--prev-icon)}
 
 .player-controls__buttons .player-controls__right button[data-testid="control-button-skip-forward"] path,
 .player-controls__buttons .player-controls__right button[aria-label="${r.skipForward}"] path {
   fill: var(--clr-on-surface);
   d: var(--next-icon)}
 
 .player-controls__left button[aria-label*="${r.disableShuffle}"],
 .player-controls__left button[aria-label*="${r.disableShuffleSpecific}"],
 .player-controls__left button[aria-label*="${r.disableShuffleGeneric}"],
 .player-controls__left button[aria-label*="${r.enableShuffle}"],
 .player-controls__left button[aria-label*="${r.enableShuffleSpecific}"],
 .player-controls__left button[aria-label*="${r.enableShuffleGeneric}"],
 .player-controls__left button[aria-label*="${r.enableSmartShuffleGeneric}"],
 .player-controls__left button[aria-label*="${r.enableSmartShuffleSpecific}"],
 .player-controls__right button[aria-label="${r.enableRepeat}"],
 .player-controls__right button[aria-label="${r.enableRepeatOne}"],
 .player-controls__right button[aria-label="${r.disableRepeat}"] {
 	--encore-graphic-size-decorative-smaller: 22px;
 	--encore-control-size-smaller: 22px}
 
 .player-controls__right button[aria-label="${r.enableRepeat}"] path {
 	d: var(--disable-repeat-icon)}
 .player-controls__right button[aria-label="${r.enableRepeatOne}"] path {
   d: var(--repeat-icon)}
 
 .player-controls__right button[aria-label="${r.disableRepeat}"] path {
   d: var(--repeat-one-icon)}
 
 .player-controls__left button[aria-label*="${r.enableShuffle}"] path,
 .player-controls__left button[aria-label*="${r.enableShuffleSpecific}"] path,
 .player-controls__left button[aria-label*="${r.enableShuffleGeneric}"] path {
 	d: var(--disable-shuffle-icon)}
 
 .player-controls__left button[aria-label*="${r.disableShuffleSpecific}"] path,
 .player-controls__left button[aria-label*="${r.disableShuffle}"] path,
 .player-controls__left button[aria-label*="${r.enableSmartShuffleGeneric}"] path,
 .player-controls__left button[aria-label*="${r.enableSmartShuffleSpecific}"] path {
 	d: var(--shuffle-icon)}
 
 .player-controls__left button[aria-label*="${r.disableShuffleSpecific}"] path,
 .player-controls__left button[aria-label*="${r.disableShuffleGeneric}"] path {
 	d: var(--smart-shuffle-icon)}
 
 .main-actionBar-ActionBarRow button[aria-label*="${r.enableShuffle}"] path,
 .main-actionBar-ActionBarRow button[aria-label*="${r.enableShuffleSpecific}"] path,
 .main-actionBar-ActionBarRow button[aria-label*="${r.enableShuffleGeneric}"] path {
   d: var(--disable-shuffle-icon-24, var(--disable-shuffle-icon))}
 
 .main-actionBar-ActionBarRow button[aria-label*="${r.disableShuffleSpecific}"] path,
 .main-actionBar-ActionBarRow button[aria-label*="${r.disableShuffle}"] path,
 .main-actionBar-ActionBarRow button[aria-label*="${r.enableSmartShuffleGeneric}"] path,
 .main-actionBar-ActionBarRow button[aria-label*="${r.enableSmartShuffleSpecific}"] path {
   d: var(--shuffle-icon-24, var(--shuffle-icon))}
 
 .main-actionBar-ActionBarRow button[aria-label*="${r.disableShuffleSpecific}"] path,
 .main-actionBar-ActionBarRow button[aria-label*="${r.disableShuffleGeneric}"] path {
   d: var(--smart-shuffle-icon-24, var(--smart-shuffle-icon))}
 
 .ix_8kg3iUb9VS5SmTnBY button[aria-label*="${r.play}"] svg[viewBox="0 0 24 24"] path {
   d: var(--play-icon-24, var(--play-icon))}
 
 .ix_8kg3iUb9VS5SmTnBY button[aria-label*="${r.pause}"] svg[viewBox="0 0 24 24"] path {
   d: var(--pause-icon-24, var(--pause-icon))}
 
 .ix_8kg3iUb9VS5SmTnBY button[aria-label*="${r.play}"] svg[viewBox="0 0 16 16"] path {
   d: var(--play-icon)}
 
 .ix_8kg3iUb9VS5SmTnBY button[aria-label*="${r.pause}"] svg[viewBox="0 0 16 16"] path {
   d: var(--pause-icon)}
 
 .player-controls__buttons .player-controls__right button[data-testid="control-button-skip-forward"],
 .player-controls__buttons .player-controls__right button[aria-label="${r.skipForward}"],
 .player-controls__buttons .player-controls__left button[data-testid="control-button-skip-back"],
 .player-controls__buttons .player-controls__left button[aria-label*="${r.skipBack}"] {
 	--encore-graphic-size-decorative-smaller: 22px;
 	--encore-control-size-smaller: 22px;
 	color: var(--subtext-color)}
 
 .player-controls__buttons button[aria-label="${r.play}"] path {
   fill: var(--clr-on-surface);
   d: var(--play-icon)}
 
 
 .player-controls__buttons button[aria-label="${r.pause}"] path {
   fill: var(--clr-on-surface);
   d: var(--pause-icon)}
 
 .player-controls__buttons > button,
 .player-controls__buttons button[data-testid=control-button-playpause] { --encore-graphic-size-decorative-smaller: 1.5rem; --encore-control-size-smaller: 1.5rem; }
 .player-controls__buttons button[data-testid=control-button-playpause],
 .player-controls__buttons button[data-testid=control-button-playpause]:hover,
 .player-controls__buttons button[data-testid=control-button-playpause] span:hover,
 .player-controls__buttons button[data-testid=control-button-playpause] span { background: none !important; }
 
 .x-downloadButton-DownloadButton button[aria-label="${r.download}"] path,
 .x-downloadButton-DownloadButton button[aria-label="${r.downloadContext}"] path {
   d: var(--download-icon-24)}
   
 svg path[d="M3 8a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm6.5 0a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zM16 8a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z"],
 .Root__right-sidebar button[aria-label*="${r.moreContext}"] path{
   d: var(--more-horizontal-icon)}
 
 .main-actionBar-ActionBar button[aria-label*="${r.moreContext}"] path {
   d: var(--more-horizontal-icon-24)}
 
 x-filterBox-expandButton[aria-label*="${r.search}"] path,
 x-filterBox-expandButton[aria-label*="${r.searchPlaylist}"] path,
 .x-filterBox-searchIcon path {
   d: var(--search-icon)}
 
 button[aria-label="${r.copyTrackLink}"] svg[viewBox="0 0 16 16"] path,
 button[aria-label="${r.copyTrackLink}"] svg[viewBox="0 0 16 16"] path,
 button[aria-label="${r.copyTrackLink}"] svg[viewBox="0 0 16 16"] path{
   d: var(--share-icon)}
 
 button[aria-label="${r.copyTrackLink}"] svg[viewBox="0 0 24 24"] path,
 button[aria-label="${r.copyTrackLink}"] svg[viewBox="0 0 24 24"] path,
 button[aria-label="${r.copyTrackLink}"] svg[viewBox="0 0 24 24"] path{
   d: var(--share-icon-24)}
 
 svg path[d="M15 14.5H5V13h10v1.5zm0-5.75H5v-1.5h10v1.5zM15 3H5V1.5h10V3zM3 3H1V1.5h2V3zm0 11.5H1V13h2v1.5zm0-5.75H1v-1.5h2v1.5z"],
 button[aria-controls="sort-and-view-picker"] path,
 .x-sortBox-sortDropdown path {
   d: var(--text-bullet-list-icon)}
 
 svg path[d="M15.5 13.5H.5V12h15v1.5zm0-4.75H.5v-1.5h15v1.5zm0-4.75H.5V2.5h15V4z"]{
   d: var(--list-icon)}
 
 div[data-testid="PanelHeader_CloseButton"] button path,
 .Root__right-sidebar button[aria-label="${r.closeBtn}"] path,
 .Root__right-sidebar button[aria-label="${r.close}"] path{
   d: var(--dismiss-icon)}
 
 .main-trackList-trackListRowGrid button[aria-label="${r.duration}"] path{
   d: var(--clock-icon)}
 
 button[aria-label="${r.createPlaylist}"] path,
 button[aria-label="${r.createButton}"] path,
 svg path[d="M15.25 8a.75.75 0 0 1-.75.75H8.75v5.75a.75.75 0 0 1-1.5 0V8.75H1.5a.75.75 0 0 1 0-1.5h5.75V1.5a.75.75 0 0 1 1.5 0v5.75h5.75a.75.75 0 0 1 .75.75z"]{
   d: var(--add-icon)}
 
 svg path[d="M6.53 9.47a.75.75 0 0 1 0 1.06l-2.72 2.72h1.018a.75.75 0 0 1 0 1.5H1.25v-3.579a.75.75 0 0 1 1.5 0v1.018l2.72-2.72a.75.75 0 0 1 1.06 0zm2.94-2.94a.75.75 0 0 1 0-1.06l2.72-2.72h-1.018a.75.75 0 1 1 0-1.5h3.578v3.579a.75.75 0 0 1-1.5 0V3.81l-2.72 2.72a.75.75 0 0 1-1.06 0z"],
 button[data-testid="fullscreen-mode-button"] path,
 button[aria-label="${r.fullscreen}"] path{
   d: var(--arrow-maximize-icon);
 }
 
 svg path[d="M15 15H1v-1.5h14V15zm0-4.5H1V9h14v1.5zm-14-7A2.5 2.5 0 0 1 3.5 1h9a2.5 2.5 0 0 1 0 5h-9A2.5 2.5 0 0 1 1 3.5zm2.5-1a1 1 0 0 0 0 2h9a1 1 0 1 0 0-2h-9z"],
 button[data-testid="control-button-queue"] path,
 button[aria-label="${r.queue}"] path{
   /* d: var(--queue-icon); */ /* TODO: add new queue icon */
 }
 
 
 button[aria-label="${r.openMiniPlayer}"] path,
 button[data-testid="pip-toggle-button"] path{
   d: var(--pip-icon);
 }
 `}catch(o){console.error("Error patching icons.",o),y("Error patching icons.",!0,5e3)}};var Ie=class extends HTMLElement{};customElements.define("lucid-main",Ie);var $t=Ie;function Vt(t){try{let e=new URL(t).searchParams.get("family");return e?e.split(":")[0].split(";")[0].replace(/\+/g," "):null}catch(o){return console.error("Error parsing Google Fonts URL:",o),null}}function Dt(){Nt(),g.subscribe(t=>{Nt(t.font)})}function Nt(t=g.getState().font){let o=S("lucid-font"),e=document.head.querySelector("#lucid-custom-font");if(t.isGoogleFonts&&t.fontUrl){e?e.href!==t.fontUrl&&(e.href=t.fontUrl):(e=m("link",{id:"lucid-custom-font",rel:"preload",href:t.fontUrl,as:"style",crossOrigin:"anonymous"}),document.head.appendChild(e));let r=document.head.querySelector("#lucid-custom-font-style");r?r.href!==t.fontUrl&&(r.href=t.fontUrl):(r=m("link",{id:"lucid-custom-font-style",rel:"stylesheet",href:t.fontUrl,crossOrigin:"anonymous"}),document.head.appendChild(r))}else{e&&e.remove();let r=document.head.querySelector("#lucid-custom-font-style");r&&r.remove()}let i=t.isGoogleFonts&&t.fontUrl?Vt(t.fontUrl):t.fontFamily;o.innerText=`:root,* { --custom-font: "${i}"; font-family: var(--custom-font) !important; }`}var Te=null,Le=null;function Ze(t=g.getState().pages){let o=`playlist-${t.style}`;Te!==o&&(Te?document.body.classList.replace(Te,o):document.body.classList.add(o),Te=o);let e=`playlist-image-${t.imageStyle}`;Le!==e&&(Le?document.body.classList.replace(Le,e):document.body.classList.add(e),Le=e),t.hideHomeHeader?document.body.classList.remove("hide-home-header"):document.body.classList.add("hide-home-header"),document.body.style.setProperty("--custom-panel-gap",`${t.panelGap}px`)}g.subscribe(t=>{Ze(t.pages)},"pages");function Gt(t){try{let o=new Blob([t],{type:"application/javascript"}),e=URL.createObjectURL(o),i=new Worker(e,{credentials:"omit"});return i.onerror=r=>{console.error("Worker encountered an error:",r.message||r)},i.onmessage=r=>{console.debug("Worker initialized:",r.data)},i}catch(o){return console.error("Error loading worker:",o),null}}var R=null,Be=null,kr=S("clr-lucid");function zt(t){R&&R.postMessage({type:"color",options:t})}function Kt(t){R&&R.postMessage({type:"image",options:t})}function Wt(t){return t.replace("spotify:image:","https://i.scdn.co/image/")}async function Xe(t=g.getState().color){var o;if(await xr(),Be==null||Be(),t.isDynamic){let e=w.getState().url;e&&Kt({url:Wt(e),isTonal:t.isTonal,isDark:!0,extractorOptions:(o=t==null?void 0:t.extractorOptions)!=null?o:{}}),Be=w.subscribe(i=>{var r;i.url&&Kt({url:Wt(i.url),isTonal:t.isTonal,isDark:!0,extractorOptions:(r=t==null?void 0:t.extractorOptions)!=null?r:{}})});return}if(t.isCustom){zt({hex:t.customColor.hex,isTonal:t.isTonal,isDark:!0});return}zt({hex:wt,isTonal:t.isTonal,isDark:!0})}async function xr(){let t=await O(Et,we);if(R=Gt(t),!R){document.body.removeAttribute("color-from-worker"),console.error("Failed to initialize worker from both endpoints."),y("Failed to initialize the color worker. If this issue persists, please report it. (Dynamic and custom colors may not function properly.)",!0,5e3);return}document.body.setAttribute("color-from-worker","true"),R.onmessage=o=>{let{message:e,data:i}=o.data||{};i?(console.debug(e,`
Event Data:`,o.data),kr.textContent=`:root,body{${i.style}}`):console.error(e!=null?e:"Color not applied")},R.onerror=o=>{console.error("Worker encountered an error:",o.message||o)}}var Ir=t=>Spicetify.URI.isPlaylistV1OrV2(t)?"playlist":Spicetify.URI.isArtist(t)?"artist":Spicetify.URI.isAlbum(t)?"album":Spicetify.URI.isGenre(t)?"genre":Spicetify.URI.isShow(t)?"show":Spicetify.URI.isSearch(t)?"search":Spicetify.URI.isProfile(t)?"profile":Spicetify.URI.isConcert(t)||Spicetify.URI.isArtistConcerts(t)?"concert":"other";function qt(t){document.body.setAttribute("path",t),document.body.setAttribute("page-type",Ir(t))}function Yt(){var t,o,e,i,r;qt(((e=(o=(t=Spicetify==null?void 0:Spicetify.Platform)==null?void 0:t.History)==null?void 0:o.location)==null?void 0:e.pathname)||"/"),(r=(i=Spicetify==null?void 0:Spicetify.Platform)==null?void 0:i.History)==null||r.listen(a=>{!a||!a.pathname||qt(a.pathname)})}var Me=()=>{var t,o;return Spicetify.Platform&&Spicetify.Platform.operatingSystem==="Windows"?!0:(o=(t=Spicetify.Platform)==null?void 0:t.PlatformData)!=null&&o.os_name?Spicetify.Platform.PlatformData.os_name.toLowerCase().includes("win"):!1};function Tr(){let t=Math.round(window.outerHeight/window.innerHeight*100)/100,o=Math.round(window.innerHeight/window.outerHeight*100)/100;return{zoom:t,inverseZoom:o}}var Jt,Zt=((Jt=Spicetify==null?void 0:Spicetify.Platform)==null?void 0:Jt.version)>="1.2.46";function Lr(t){let{zoom:o,inverseZoom:e}=Tr(),i=Zt&&t>32?Math.max(32,Math.round(t/(2*o))):t/o,r=Math.round(135*e),a=Zt?(t/o-Math.min(32/o,t))/2:0,s=S("transparent-controls");s.textContent=`
    body::after {
      content: "";
      height: var(--control-height, ${i}px);
      width: var(--control-width, ${r}px);
      position: fixed;
      top: ${a}px;
      right: 0;
      -webkit-backdrop-filter: brightness(2.1);
      backdrop-filter: brightness(2.1);
    }
  `}async function Br(t){var o,e,i,r,a,s;await((i=(e=(o=Spicetify==null?void 0:Spicetify.Platform)==null?void 0:o.ControlMessageAPI)==null?void 0:e._updateUiClient)==null?void 0:i.updateTitlebarHeight({height:t})),await((s=(a=(r=Spicetify==null?void 0:Spicetify.Platform)==null?void 0:r.UpdateAPI)==null?void 0:a._updateUiClient)==null?void 0:s.updateTitlebarHeight({height:t})),await Spicetify.CosmosAsync.post("sp://messages/v1/container/control",{type:"update_titlebar",height:`${t}px`})}function Je(t=g.getState().control.height){Br(t).then(()=>Lr(t)).catch(o=>console.error("Failed to update titlebar:",o))}function Xt(){let t=setInterval(()=>Je(),300);setTimeout(()=>{clearInterval(t)},1e4)}var Qt=()=>{Me()&&(Je(),Xt(),window.addEventListener("resize",Xt),g.subscribe(t=>Je(t.control.height),"control"))};var A=t=>{if(t<0||t>100)throw new Error("Alpha value must be between 0 and 100");let o=t/100,i=Math.round(o*255).toString(16).toUpperCase();return i.length===1&&(i=`0${i}`),i};function jt(t=g.getState().playbar){var i,r,a,s,p,d,n,h;let o=t.options[t.type],e=S("lucid-playbar");e.textContent=`
    :root,
    .Root__now-playing-bar{
        --npb-height: ${(i=o.height)!=null?i:80}px;
        --npb-blur: ${(r=o.backdropFilter.blur)!=null?r:32}px;
        --npb-padding-x: ${(a=o.paddingX)!=null?a:8}px;
        --npb-saturate: ${(s=o.backdropFilter.saturate)!=null?s:150}%;
        --npb-brightness: ${(p=o.backdropFilter.brightness)!=null?p:80}%;
        --npb-border-radius: ${(d=o.borderRadius)!=null?d:8}px;
        --npb-image-radius: ${(n=o.imageRadius)!=null?n:16}px;
        --npb-bg-opacity: ${(h=o.bgOpacity)!=null?h:50}%;
        --npb-bg-color: ${o.bgColor.hex?o.bgColor.hex+A(o.bgColor.alpha):`rgba(var(--clr-surface-1-rgb), ${o.bgColor.alpha}%)`} ;
    }`,t.isFloating?document.body.setAttribute("npb-is-floating","floating"):document.body.removeAttribute("npb-is-floating"),document.body.setAttribute("npb-type",t.type)}var C=document.querySelector(".Root__now-playing-bar");P([".Root__now-playing-bar"],([t])=>{C=t,Qe()});var Pe=g.getState().playbar.hideIcons;function Qe(){if(!C)return;let t=C.offsetWidth;C.style.setProperty("--width",`${t}px`),je(Pe||t<1e3)}function je(t=g.getState().playbar.hideIcons){C&&(t?C.setAttribute("hide-icons","true"):C.removeAttribute("hide-icons"))}function eo(){window.addEventListener("resize",Qe),jt(),je(Pe||((C==null?void 0:C.clientWidth)||0)<900),g.subscribe(t=>{Pe=t.playbar.hideIcons,je(Pe||((C==null?void 0:C.clientWidth)||0)<900),jt(t.playbar)},"playbar"),Qe()}var B=new z({isFloating:!1,position:{top:16,left:16}},{persist:!0,localStorageKey:"lucid-modal-position"});var to='<svg width="24" height="24" fill="none" viewBox="0 0 24 24"><path d="m4.21 4.387.083-.094a1 1 0 0 1 1.32-.083l.094.083L12 10.585l6.293-6.292a1 1 0 1 1 1.414 1.414L13.415 12l6.292 6.293a1 1 0 0 1 .083 1.32l-.083.094a1 1 0 0 1-1.32.083l-.094-.083L12 13.415l-6.293 6.292a1 1 0 0 1-1.414-1.414L10.585 12 4.293 5.707a1 1 0 0 1-.083-1.32l.083-.094-.083.094Z" fill="currentColor"/></svg>',oo='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 30" width="24px" height="24px"><path fill="currentColor" d="M15,3C8.373,3,3,8.373,3,15c0,5.623,3.872,10.328,9.092,11.63C12.036,26.468,12,26.28,12,26.047v-2.051 c-0.487,0-1.303,0-1.508,0c-0.821,0-1.551-0.353-1.905-1.009c-0.393-0.729-0.461-1.844-1.435-2.526 c-0.289-0.227-0.069-0.486,0.264-0.451c0.615,0.174,1.125,0.596,1.605,1.222c0.478,0.627,0.703,0.769,1.596,0.769 c0.433,0,1.081-0.025,1.691-0.121c0.328-0.833,0.895-1.6,1.588-1.962c-3.996-0.411-5.903-2.399-5.903-5.098 c0-1.162,0.495-2.286,1.336-3.233C9.053,10.647,8.706,8.73,9.435,8c1.798,0,2.885,1.166,3.146,1.481C13.477,9.174,14.461,9,15.495,9 c1.036,0,2.024,0.174,2.922,0.483C18.675,9.17,19.763,8,21.565,8c0.732,0.731,0.381,2.656,0.102,3.594 c0.836,0.945,1.328,2.066,1.328,3.226c0,2.697-1.904,4.684-5.894,5.097C18.199,20.49,19,22.1,19,23.313v2.734 c0,0.104-0.023,0.179-0.035,0.268C23.641,24.676,27,20.236,27,15C27,8.373,21.627,3,15,3z"/></svg>',ro='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 30" width="24px" height="24px"><path fill="currentColor" d="M25.12,6.946c-2.424-1.948-6.257-2.278-6.419-2.292c-0.256-0.022-0.499,0.123-0.604,0.357 c-0.004,0.008-0.218,0.629-0.425,1.228c2.817,0.493,4.731,1.587,4.833,1.647c0.478,0.278,0.638,0.891,0.359,1.368 C22.679,9.572,22.344,9.75,22,9.75c-0.171,0-0.343-0.043-0.501-0.135C21.471,9.598,18.663,8,15.002,8 C11.34,8,8.531,9.599,8.503,9.615C8.026,9.892,7.414,9.729,7.137,9.251C6.86,8.775,7.021,8.164,7.497,7.886 c0.102-0.06,2.023-1.158,4.848-1.65c-0.218-0.606-0.438-1.217-0.442-1.225c-0.105-0.235-0.348-0.383-0.604-0.357 c-0.162,0.013-3.995,0.343-6.451,2.318C3.564,8.158,1,15.092,1,21.087c0,0.106,0.027,0.209,0.08,0.301 c1.771,3.11,6.599,3.924,7.699,3.959c0.007,0,0.013,0,0.019,0.001c0.194,0,0.377-0.093,0.492-0.25l1.19-1.612 c-2.61-0.629-3.99-1.618-4.073-1.679c-0.444-0.327-0.54-0.953-0.213-1.398c0.326-0.443,0.95-0.541,1.394-0.216 C7.625,20.217,10.172,22,15,22c4.847,0,7.387-1.79,7.412-1.808c0.444-0.322,1.07-0.225,1.395,0.221 c0.324,0.444,0.23,1.066-0.212,1.392c-0.083,0.061-1.456,1.048-4.06,1.677l1.175,1.615c0.115,0.158,0.298,0.25,0.492,0.25 c0.007,0,0.013,0,0.019-0.001c1.101-0.035,5.929-0.849,7.699-3.959c0.053-0.092,0.08-0.195,0.08-0.301 C29,15.092,26.436,8.158,25.12,6.946z M11,19c-1.105,0-2-1.119-2-2.5S9.895,14,11,14s2,1.119,2,2.5S12.105,19,11,19z M19,19 c-1.105,0-2-1.119-2-2.5s0.895-2.5,2-2.5s2,1.119,2,2.5S20.105,19,19,19z"/></svg>',Oe='<svg width="24" height="24" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m8.5 16.586-3.793-3.793a1 1 0 0 0-1.414 1.414l4.5 4.5a1 1 0 0 0 1.414 0l11-11a1 1 0 0 0-1.414-1.414L8.5 16.586Z" fill="currentColor"/></svg>',io='<svg width="24" height="24" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 2c5.523 0 10 4.478 10 10s-4.477 10-10 10S2 17.522 2 12 6.477 2 12 2Zm0 1.667c-4.595 0-8.333 3.738-8.333 8.333 0 4.595 3.738 8.333 8.333 8.333 4.595 0 8.333-3.738 8.333-8.333 0-4.595-3.738-8.333-8.333-8.333ZM12 15.5a1 1 0 1 1 0 2 1 1 0 0 1 0-2Zm0-8.75a2.75 2.75 0 0 1 2.75 2.75c0 1.01-.297 1.574-1.051 2.359l-.169.171c-.622.622-.78.886-.78 1.47a.75.75 0 0 1-1.5 0c0-1.01.297-1.574 1.051-2.359l.169-.171c.622-.622.78-.886.78-1.47a1.25 1.25 0 0 0-2.493-.128l-.007.128a.75.75 0 0 1-1.5 0A2.75 2.75 0 0 1 12 6.75Z" fill="currentColor"/></svg>',no='<svg width="24" height="24" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M21.03 2.97a3.578 3.578 0 0 0-5.06 0L14 4.94l-.013-.013a1.75 1.75 0 0 0-2.475 0l-.585.586a1.75 1.75 0 0 0 0 2.474l.012.013-6.78 6.78a2.25 2.25 0 0 0-.659 1.591v.688l-1.28 2.347c-.836 1.533.841 3.21 2.374 2.374l2.347-1.28h.688a2.25 2.25 0 0 0 1.59-.659L16 13.061l.012.012a1.75 1.75 0 0 0 2.475 0l.586-.585a1.75 1.75 0 0 0 0-2.475L19.061 10l1.97-1.97a3.578 3.578 0 0 0 0-5.06ZM12 9.06 14.94 12l-6.78 6.78a.75.75 0 0 1-.531.22H6.75a.75.75 0 0 0-.359.092l-2.515 1.372a.234.234 0 0 1-.159.032.264.264 0 0 1-.138-.075.264.264 0 0 1-.075-.138.234.234 0 0 1 .033-.159l1.372-2.515A.75.75 0 0 0 5 17.25v-.879a.75.75 0 0 1 .22-.53L12 9.061Z" fill="currentColor"/></svg>',et='<svg width="16" height="16" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12.012 2.25c.734.008 1.465.093 2.182.253a.75.75 0 0 1 .582.649l.17 1.527a1.384 1.384 0 0 0 1.927 1.116l1.401-.615a.75.75 0 0 1 .85.174 9.792 9.792 0 0 1 2.204 3.792.75.75 0 0 1-.271.825l-1.242.916a1.381 1.381 0 0 0 0 2.226l1.243.915a.75.75 0 0 1 .272.826 9.797 9.797 0 0 1-2.204 3.792.75.75 0 0 1-.848.175l-1.407-.617a1.38 1.38 0 0 0-1.926 1.114l-.169 1.526a.75.75 0 0 1-.572.647 9.518 9.518 0 0 1-4.406 0 .75.75 0 0 1-.572-.647l-.168-1.524a1.382 1.382 0 0 0-1.926-1.11l-1.406.616a.75.75 0 0 1-.849-.175 9.798 9.798 0 0 1-2.204-3.796.75.75 0 0 1 .272-.826l1.243-.916a1.38 1.38 0 0 0 0-2.226l-1.243-.914a.75.75 0 0 1-.271-.826 9.793 9.793 0 0 1 2.204-3.792.75.75 0 0 1 .85-.174l1.4.615a1.387 1.387 0 0 0 1.93-1.118l.17-1.526a.75.75 0 0 1 .583-.65c.717-.159 1.45-.243 2.201-.252Zm0 1.5a9.135 9.135 0 0 0-1.354.117l-.109.977A2.886 2.886 0 0 1 6.525 7.17l-.898-.394a8.293 8.293 0 0 0-1.348 2.317l.798.587a2.881 2.881 0 0 1 0 4.643l-.799.588c.32.842.776 1.626 1.348 2.322l.905-.397a2.882 2.882 0 0 1 4.017 2.318l.11.984c.889.15 1.798.15 2.687 0l.11-.984a2.881 2.881 0 0 1 4.018-2.322l.905.396a8.296 8.296 0 0 0 1.347-2.318l-.798-.588a2.881 2.881 0 0 1 0-4.643l.796-.587a8.293 8.293 0 0 0-1.348-2.317l-.896.393a2.884 2.884 0 0 1-4.023-2.324l-.11-.976a8.988 8.988 0 0 0-1.333-.117ZM12 8.25a3.75 3.75 0 1 1 0 7.5 3.75 3.75 0 0 1 0-7.5Zm0 1.5a2.25 2.25 0 1 0 0 4.5 2.25 2.25 0 0 0 0-4.5Z" fill="currentColor"/></svg>';var ao="https://github.com/sanoojes/Spicetify-Lucid",so="https://discord.gg/PWEyKduwJh";var Mr=(t="base")=>`encore-internal-color-text-${t}`,F=(t="variable-text",o="base")=>`encore-text ${t==="variable-text"?`encore-${t}`:`encore-text-${t}`} ${Mr(o)}`;var k=class extends HTMLElement{constructor(e){var i,r,a,s;super();c(this,"customClass","");c(this,"_type","primary");c(this,"_isIcon",!1);c(this,"onChange");c(this,"_handleClick",()=>{!this.disabled&&this.onChange&&this.onChange()});e&&(this.type=(i=e.type)!=null?i:this.type,this.customClass=(r=e.customClass)!=null?r:this.customClass,this.disabled=(a=e.disabled)!=null?a:this.disabled,this.isIcon=(s=e.isIcon)!=null?s:this._isIcon,this.onChange=e.onChange,e.textContent&&(this.textContent=e.textContent),e.innerHTML&&(this.innerHTML=e.innerHTML),e.ariaLabel&&(this.ariaLabel=e.ariaLabel),e.style&&Object.assign(this.style,e.style)),this.addEventListener("click",this._handleClick)}connectedCallback(){this.classList.add("lucid-button"),this._updateClasses(),this.setAttribute("role","button")}disconnectedCallback(){this.removeEventListener("click",this._handleClick)}_updateClasses(){this.className=`lucid-button ${this.customClass}`,this.classList.toggle("icon",this._isIcon),this.classList.toggle("disabled",this.disabled);for(let e of this.classList)["primary","secondary","tertiary","danger"].includes(e)&&this.classList.remove(e);if(this.classList.add(this.type),this._isIcon&&this.type==="icon"){let e=F("body-small-bold");e&&this.classList.add(e)}}set isIcon(e){this._isIcon=e,e?(this.classList.add("icon"),this.setAttribute("is-icon","true")):(this.classList.remove("icon"),this.removeAttribute("is-icon")),this._updateClasses()}get isIcon(){return this._isIcon}set type(e){this._type=e,this.setAttribute("type",e),this._updateClasses()}get type(){return this._type}set disabled(e){e?(this.setAttribute("disabled","true"),this.setAttribute("aria-disabled","true")):(this.removeAttribute("disabled"),this.removeAttribute("aria-disabled")),this._updateClasses()}get disabled(){return this.hasAttribute("disabled")}};customElements.define("custom-button",k);var K=class K extends HTMLElement{constructor(){super();c(this,"_modalElem");c(this,"_bodyElem");c(this,"_scrollElem");c(this,"_closeBtn");c(this,"_githubBtn");c(this,"_discordBtn");c(this,"_headerWrapperElem");c(this,"_headerElem");c(this,"_bgElem");c(this,"_previouslyFocusedElement",null);this._bgElem=m("div",{className:"modal-backdrop"}),this._bgElem.addEventListener("click",()=>this.close()),this._modalElem=m("div",{className:"modal",role:"dialog",ariaModal:"true"}),this._headerWrapperElem=m("div",{className:"modal-header-container"}),this._headerElem=m("h2",{className:`modal-header ${F("title-small")}`,id:"modal-header"});let e=m("div",{className:"modal-header-buttons"});this._closeBtn=this.createIconButton("close","Close Button",to,()=>this.close()),this._githubBtn=this.createIconButton("github","Github Button",oo,()=>window.open(ao)),this._discordBtn=this.createIconButton("discord","Discord Button",ro,()=>window.open(so)),e.append(this._discordBtn,this._githubBtn,this._closeBtn),this._headerWrapperElem.append(this._headerElem,e),this._modalElem.appendChild(this._headerWrapperElem),this._bodyElem=m("div",{className:"modal-body"}),this._scrollElem=m("div",{className:"modal-scroll"}),this._bodyElem.appendChild(this._scrollElem),this._modalElem.appendChild(this._bodyElem),this.append(this._bgElem,this._modalElem)}createIconButton(e,i,r,a){let s=new k;return s.customClass=e,s.ariaLabel=i,s.innerHTML=r.toString(),s.type="icon",s.addEventListener("click",a),s}resetPosition(){this._modalElem.style.transform="translate3d(-50%,-50%,0px)"}get scrollElem(){return this._scrollElem}set isOpen(e){e?this.setAttribute("open","true"):this.removeAttribute("open")}get isOpen(){return!!this.getAttribute("open")}setHeader(e){this._headerElem.innerHTML=e.toString()}open(){this.isOpen=!0,this._previouslyFocusedElement=document.activeElement,this._bgElem.classList.add("modal-backdrop--open"),this._modalElem.classList.add("modal--open"),this._closeBtn.focus(),this.resetPosition(),K.zIndexCounter+=1,this._bgElem.style.zIndex=String(K.zIndexCounter),this._modalElem.style.zIndex=String(K.zIndexCounter),this.dispatchEvent(new Event("open"))}close(){this.isOpen=!1,this._bgElem.classList.remove("modal-backdrop--open"),this._modalElem.classList.remove("modal--open"),this.removeAttribute("open"),this._previouslyFocusedElement&&(this._previouslyFocusedElement.focus(),this._previouslyFocusedElement=null),this.dispatchEvent(new Event("close"))}setContent(e){this._scrollElem.textContent="",typeof e=="string"?this._scrollElem.textContent=e:this._scrollElem.append(e)}};c(K,"zIndexCounter",1e3);var G=K;customElements.define("lucid-modal",G);var W=class extends G{constructor(){super();c(this,"dragging",!1);c(this,"startX",0);c(this,"startY",0);c(this,"initialLeft",0);c(this,"initialTop",0);c(this,"setPosition",(e,i)=>{B.setState(r=>({isFloating:r.isFloating,position:{top:e,left:i}}))});c(this,"handlePointerDown",e=>{if(!this.isFloating)return;this.dragging=!0,this.startX=e.clientX,this.startY=e.clientY;let i=this._modalElem.getBoundingClientRect();this.initialLeft=i.left,this.initialTop=i.top,this.setAttribute("dragging","true"),document.addEventListener("pointermove",this.handlePointerMove),document.addEventListener("pointerup",this.handlePointerUp)});c(this,"handlePointerMove",e=>{if(!this.dragging)return;let i=e.clientX-this.startX,r=e.clientY-this.startY,a=this.initialLeft+i,s=this.initialTop+r,p=this._modalElem.getBoundingClientRect(),d=p.width,n=p.height;a=Math.max(0,Math.min(a,window.innerWidth-d-16)),s=Math.max(0,Math.min(s,window.innerHeight-n-16)),this._modalElem.style.transform=`translate3d(${a}px,${s}px,0px)`,this.setPosition(s,a)});c(this,"handlePointerUp",e=>{this.dragging=!1,this.removeAttribute("dragging"),document.removeEventListener("pointermove",this.handlePointerMove),document.removeEventListener("pointerup",this.handlePointerUp)});super.setHeader("Lucid Settings")}makeFloating(){let e=B.getState().position;e&&e.top!==void 0&&e.left!==void 0&&(this._modalElem.style.transform=`translate3d(${e.left}px,${e.top}px,0px)`),this.setAttribute("floating","true"),this._modalElem.classList.add("modal--floating"),this._bgElem.classList.add("modal-backdrop--floating"),this._headerWrapperElem.addEventListener("pointerdown",this.handlePointerDown)}removeFloating(){this.removeAttribute("floating"),this.resetPosition(),this._bgElem.classList.remove("modal-backdrop--floating"),this._modalElem.classList.remove("modal--floating"),this._headerWrapperElem.removeEventListener("pointerdown",this.handlePointerDown)}set isFloating(e){e?(this.setAttribute("is-floating","true"),this.makeFloating()):(this.removeAttribute("is-floating"),this.removeFloating())}get isFloating(){return!!this.getAttribute("is-floating")}open(){if(super.open(),this.isFloating){let e=B.getState().position;e&&e.top!==void 0&&e.left!==void 0&&(this._modalElem.style.transform=`translate3d(${e.left}px,${e.top}px,0px)`)}}};customElements.define("lucid-settings-modal",W);window.Modal=G;window.FloatingModal=W;var H=null;function tt(t,o){var e,i,r;H&&(H instanceof Spicetify.Topbar.Button?(e=H.element)==null||e.remove():H.deregister(),H=null),t==="context-menu"?(i=Spicetify==null?void 0:Spicetify.Menu)!=null&&i.Item?(H=new Spicetify.Menu.Item("Lucid Settings",!1,o,et),H.register()):console.error("Context menu unavailable.Try Switching to Nav."):t==="nav"&&((r=Spicetify==null?void 0:Spicetify.Topbar)!=null&&r.Button?H=new Spicetify.Topbar.Button("Lucid Settings",et,o,!1,!0):console.error("Nav bar unavailable.Try Switching to Context Menu."))}var U=null,I=null,Pr=100,Or=150,v=m("div",{id:"tooltip",role:"tooltip",ariaHidden:"true",style:{position:"fixed",display:"block",padding:"0.5rem 1rem",border:"1px solid var(--border-color, var(--clr-surface-0))",color:"var(--clr-on-surface, #fafafa)",backgroundColor:"rgba(var(--clr-surface-0-rgb, var(--spice-rgb-main)), 0.85)",borderRadius:"6px",boxShadow:"0 4px 12px rgba(var(--clr-shadow-rgb), 0.25)",backdropFilter:"blur(10px)",transition:"opacity 0.2s ease-out, transform 0.2s ease-out, visibility 0.2s ease-out",pointerEvents:"auto",zIndex:"1000",opacity:"0",visibility:"hidden",transform:"translateY(-5px) scale(0.95)",maxWidth:`${window.innerWidth/2}px`,fontSize:"0.875rem",textAlign:"center"}}),oe=m("span",{className:"tooltip-content",style:{display:"inline-block",transition:"opacity 0.3s ease"}});v.appendChild(oe);document.body.appendChild(v);v.addEventListener("mouseenter",()=>{I&&(clearTimeout(I),I=null)});v.addEventListener("mouseleave",()=>{lo()});function Rr(t,o){o&&(I&&(clearTimeout(I),I=null),U&&(clearTimeout(U),U=null),U=setTimeout(()=>{typeof o=="string"?oe.innerHTML=`<span style="font-weight: 500; color: inherit;">${o}</span>`:(oe.innerHTML="",oe.appendChild(o)),v.style.visibility="visible",v.style.opacity="1",v.style.transform="translateY(0) scale(1)",v.setAttribute("aria-hidden","false");let e,i;if(t.target instanceof HTMLElement){let r=t.target.getBoundingClientRect();e=r.left+r.width/2-v.offsetWidth/2,i=r.top-v.offsetHeight}else e=t.clientX+10,i=t.clientY+10;e=Math.max(0,Math.min(e,window.innerWidth-v.offsetWidth)),v.style.left=`${e}px`,v.style.top=`${i}px`,v.style.maxWidth=`${window.innerWidth/2}px`,U=null},Pr))}function lo(){v.matches(":hover")||oe.matches(":hover")||(U&&(clearTimeout(U),U=null),I&&(clearTimeout(I),I=null),I=setTimeout(()=>{v.style.opacity="0",v.style.transform="translateY(-5px) scale(0.95)",v.style.visibility="hidden",v.setAttribute("aria-hidden","true"),I=null},Or))}var Re=class{constructor(o){c(this,"elem");c(this,"content");c(this,"mouseoverHandler");c(this,"mouseoutHandler");c(this,"open",!1);this.content=o,this.elem=m("div",{className:"tooltip-wrapper",innerHTML:`<span class="icon" style="height:24px; width:24px;">${io}</span>`,style:{cursor:"help",display:"inline-flex"},ariaLabel:typeof o=="string"?o:void 0,ariaHasPopup:"true"}),this.mouseoverHandler=e=>{this.open=!0,Rr(e,this.content)},this.mouseoutHandler=()=>{!this.elem.matches(":hover")&&this.open&&(lo(),this.open=!1)},this.elem.addEventListener("mouseenter",this.mouseoverHandler),this.elem.addEventListener("mouseleave",this.mouseoutHandler)}dispose(){this.elem.removeEventListener("mouseenter",this.mouseoverHandler),this.elem.removeEventListener("mouseleave",this.mouseoutHandler),this.elem.parentNode&&this.elem.parentNode.removeChild(this.elem)}};var re=class extends HTMLElement{constructor(){super();c(this,"_options",[]);c(this,"_value","");c(this,"_isOpen",!1);c(this,"_highlightedIndex",-1);c(this,"_trigger");c(this,"_selectedValueSpan");c(this,"_optionsList");c(this,"shadow");this.shadow=this.attachShadow({mode:"open"}),this.handleDocumentClick=this.handleDocumentClick.bind(this)}set options(e){this._options=e,this.renderOptions()}get options(){return this._options}set value(e){this._value=e,this.updateSelected()}get value(){return this._value}connectedCallback(){this.render(),document.addEventListener("click",this.handleDocumentClick)}disconnectedCallback(){document.removeEventListener("click",this.handleDocumentClick)}render(){this.shadow.innerHTML=`
        <style>.option,.trigger{cursor:pointer;transition:background 225ms ease-in-out}.select-container{width:100%;min-width:6rem;position:relative}.options,.options::before{width:100%;position:absolute}.trigger{padding:.5rem .75rem;background-color:var(--clr-surface-2);width:100%;display:flex;align-items:center;text-align:left;line-height:1px;justify-content:space-between;color:var(--clr-on-surface);border:var(--border-thickness,1px) var(--border-style,solid) var(--border-color,#45454550);border-radius:var(--btn-base-radius,.5rem)}.options{list-style:none;padding:0;margin:0;border:1px solid #ccc;scrollbar-width:thin;background:rgba(var(--clr-surface-1-rgb),.5);z-index:10;max-height:200px;overflow-y:auto;border:var(--border-thickness,1px) var(--border-style,solid) var(--border-color,#45454550);border-radius:var(--btn-base-radius,.5rem);-webkit-backdrop-filter:blur(8px) saturate(150%);backdrop-filter:blur(8px) saturate(150%)}.options.hidden{display:none}.option{padding:.5rem}.option:last-child{border-bottom:none}.option.highlighted,.option[aria-selected=true]{background:rgba(var(--clr-surface-2-rgb),.7)}.option:hover,.trigger:hover,.trigger[aria-expanded=true]{background:rgba(var(--clr-surface-3-rgb),.75)}.icon{color:var(--clr-on-surface,var(--spice-text));height:20px;width:20px}.trigger,.option{font-size: .85rem;font-weight:500;font-family:inherit;color: var(--clr-on-surface,var(--spice-text,#fafafa))}</style>
        <div class="select-container">
          <button type="button" class="trigger" aria-haspopup="listbox" aria-expanded="false">
            <span class="selected-value"></span>
            <span class="icon" aria-hidden="true">
              <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                <path d="M5.79681 7C4.95612 7 4.49064 7.97434 5.01887 8.62834L8.83333 13.351C9.43371 14.0943 10.5668 14.0943 11.1672 13.351L14.9816 8.62834C15.5098 7.97434 15.0444 7 14.2037 7H5.79681Z" fill="currentColor"/>
              </svg>
            </span>
          </button>
          <ul class="options hidden" role="listbox" tabindex="-1"></ul>
        </div>
      `,this._trigger=this.shadow.querySelector(".trigger"),this._selectedValueSpan=this.shadow.querySelector(".selected-value"),this._optionsList=this.shadow.querySelector(".options"),this._trigger.addEventListener("click",()=>this.checkboxOptions()),this._trigger.addEventListener("keydown",e=>this.handleTriggerKeydown(e)),this._optionsList.addEventListener("click",e=>this.handleOptionClick(e)),this._optionsList.addEventListener("keydown",e=>this.handleOptionsKeydown(e)),this.renderOptions(),this.updateSelected()}renderOptions(){if(this._optionsList){this._optionsList.innerHTML="";for(let[e,i]of this._options.entries()){let r=m("li",{role:"option",className:"option",textContent:i.label,ariaSelected:i.value===this._value?"true":"false"});r.setAttribute("data-index",e.toString()),r.setAttribute("data-value",i.value),this._optionsList.appendChild(r)}}}updateSelected(){if(!this._selectedValueSpan)return;let e=this._options.find(r=>r.value===this._value);this._selectedValueSpan.textContent=e?e.label:"Select an option";let i=Array.from(this._optionsList.children);for(let r of i){let a=r.getAttribute("data-value");r.setAttribute("aria-selected",a===this._value?"true":"false")}}checkboxOptions(){this._isOpen=!this._isOpen,this._isOpen?this.openOptions():this.closeOptions()}openOptions(){this._optionsList.classList.remove("hidden"),this._trigger.setAttribute("aria-expanded","true"),this._highlightedIndex=this._options.findIndex(e=>e.value===this._value),this._highlightedIndex===-1&&(this._highlightedIndex=0),this.highlightOption(this._highlightedIndex),this._optionsList.focus()}closeOptions(){this._isOpen=!1,this._optionsList.classList.add("hidden"),this._trigger.setAttribute("aria-expanded","false"),this._highlightedIndex=-1}handleTriggerKeydown(e){switch(e.key){case"ArrowDown":e.preventDefault(),this.openOptions();break;case"Enter":case" ":e.preventDefault(),this.checkboxOptions();break}}handleOptionsKeydown(e){switch(e.key){case"ArrowDown":e.preventDefault(),this.moveHighlight(1);break;case"ArrowUp":e.preventDefault(),this.moveHighlight(-1);break;case"Enter":e.preventDefault(),this.selectHighlighted();break;case"Escape":e.preventDefault(),this.closeOptions(),this._trigger.focus();break}}handleOptionClick(e){let i=e.target;if(i&&i.getAttribute("role")==="option"){let r=Number.parseInt(i.getAttribute("data-index")||"0",10);this._highlightedIndex=r,this.selectHighlighted()}}moveHighlight(e){let i=this._options.length;i!==0&&(this._highlightedIndex=(this._highlightedIndex+e+i)%i,this.highlightOption(this._highlightedIndex))}highlightOption(e){let i=this._optionsList.querySelectorAll(".option"),r=0;for(let a of i)r===e?(a.classList.add("highlighted"),a.scrollIntoView({block:"nearest"})):a.classList.remove("highlighted"),r++}selectHighlighted(){if(this._highlightedIndex>=0&&this._highlightedIndex<this._options.length){let e=this._options[this._highlightedIndex];this._value=e.value,this.updateSelected(),this.closeOptions(),this._trigger.focus(),this.dispatchEvent(new Event("change",{bubbles:!0}))}}handleDocumentClick(e){this.contains(e.target)||this.closeOptions()}};customElements.define("accessible-select",re);function co(t,o){if(t===o)return!0;let e=Object.keys(t),i=Object.keys(o);if(e.length!==i.length)return!1;for(let r of e)if(t[r]!==o[r])return!1;return!0}var ie=class extends HTMLElement{constructor(){super(...arguments);c(this,"_inputOptions");c(this,"_renderedOptions",null);c(this,"_inputElement",null);c(this,"_previewElement",null)}set inputOptions(e){this._inputOptions=e,this.render()}get inputOptions(){return this._inputOptions}connectedCallback(){this.render()}removeContent(){this._inputElement=null,this._previewElement=null,this.innerHTML=""}render(){var i;if(this._renderedOptions&&co(this._renderedOptions,this._inputOptions))return;this.removeContent();let e=(r,a,s)=>{let p=this._inputElement,d=p.value,n=s?s(d):d;if(!r){a==null||a(n);return}let h=r(n);h.isValid?(p.classList.remove("error","shake-error"),a==null||a(n)):(p.classList.remove("shake-error"),p.offsetWidth,p.classList.add("error","shake-error"),h.message&&y(h.message,!0,2e3))};switch(this._inputOptions.type){case"button":{let{buttonType:r,onClick:a,contents:s}=this._inputOptions;this._inputElement=new k,this._inputElement.type=r||"primary",a&&(this._inputElement.onclick=a),this._inputElement.innerHTML=(s==null?void 0:s.toString())||"Button",this.append(this._inputElement);break}case"number":{let{type:r,step:a,value:s,onChange:p,validator:d}=this._inputOptions;this._inputElement=m("input",{type:r,step:(a==null?void 0:a.toString())||"1",value:s==null?void 0:s.toString(),className:"input number"});let n=new k;n.innerHTML=Oe,n.type="icon",n.onclick=()=>e(d,p,h=>Number.parseFloat(h)),this.append(this._inputElement,n);break}case"text":{let{type:r,value:a,onChange:s,validator:p}=this._inputOptions;this._inputElement=m("input",{type:r,value:a,className:"input text"});let d=new k;d.innerHTML=Oe,d.type="icon",d.onclick=()=>e(p,s),this.append(this._inputElement,d);break}case"checkbox":{let{onChange:r,checked:a,type:s}=this._inputOptions;this._inputElement=m("input",{checked:a,type:s,className:"checkbox custom"}),this._inputElement.onchange=p=>r==null?void 0:r(p.target.checked),this.append(this._inputElement);break}case"select":{let{options:r,value:a,onChange:s}=this._inputOptions;this._inputElement=new re,r&&(this._inputElement.options=r),a&&(this._inputElement.value=a),this._inputElement.onchange=p=>s==null?void 0:s(p.target.value),this.append(this._inputElement);break}case"color":{let{value:r,onChange:a}=this._inputOptions;this._inputElement=m("input",{type:"color",value:r,className:"input color"});let s=new k;s.innerHTML=no,s.type="icon",s.onclick=async()=>{if(!("EyeDropper"in window)&&window.EyeDropper){y("EyeDropper API is not supported in this browser.",!0,3e3);return}try{if(!window.EyeDropper)return;let h=(await new window.EyeDropper().open()).sRGBHex;this._inputElement.value=h,a==null||a(h)}catch(d){d instanceof Error&&d.message!=="No color selected"&&(console.error("EyeDropper Error:",d),y("Failed to pick color with EyeDropper.",!0,3e3))}};let p=new k;p.innerHTML=Oe,p.type="icon",p.onclick=()=>{e(()=>({isValid:!0}),a)},window.EyeDropper?this.append(this._inputElement,s,p):this.append(this._inputElement,p);break}case"image":{let{onChange:r}=this._inputOptions;this._inputElement=m("input",{type:"file",accept:"image/*",className:"input image",style:{display:"none",visibility:"hidden"}}),this._previewElement=m("img",{className:"image-preview",style:{borderRadius:"0.5rem"}}),this._previewElement.src=(i=this._inputOptions.value)!=null?i:"",this.prepend(this._previewElement),this._inputElement.onchange=a=>{var d;let p=(d=a.target.files)==null?void 0:d[0];if(p){let n=new FileReader;n.onload=h=>{var L;let b=(L=h.target)==null?void 0:L.result;r==null||r(b),this._previewElement&&(this._previewElement.src=b)},n.readAsDataURL(p)}else r==null||r(null),this._previewElement&&(this._previewElement.src="")},this.append(new k({type:"primary",textContent:"Select Image",onChange:()=>{var a;(a=this._inputElement)==null||a.click()}}),this._inputElement);break}default:console.error("Unsupported input options:",this._inputOptions)}this._renderedOptions=this._inputOptions}};customElements.define("custom-input",ie);var ne=class extends HTMLElement{constructor(){super(...arguments);c(this,"_isRender",!1);c(this,"rendered",!1);c(this,"_settings",[]);c(this,"sectionElements",[])}connectedCallback(){!this.sectionElements.length&&this._settings.length&&this.createSectionElements(),this.render(),this.updateVisibility()}set options(e){this._settings=e,this.updateSectionElements(),this.render(),this.updateVisibility()}set isRender(e){this._isRender=e,this.updateVisibility()}get isRender(){return this._isRender}updateVisibility(){this._isRender?(this.removeAttribute("hidden"),this.style.display="flex",this.style.visibility="visible"):(this.setAttribute("hidden","true"),this.style.display="none",this.style.visibility="hidden")}clear(){this.innerHTML=""}createSectionElements(){this.sectionElements=[];for(let e of this._settings){let i=new ae;i.options=e,this.sectionElements.push(i)}}updateSectionElements(){let e=new Map;for(let r of this.sectionElements){let a=r._name;e.set(a,r)}let i=[];for(let r of this._settings){let a=r.name,s=e.get(a);s||(s=new ae),s.options=r,i.push(s)}this.sectionElements=i}render(){!this._settings||this._settings.length===0||this.rendered||(this.clear(),this.append(...this.sectionElements),this.rendered=!0)}};customElements.define("settings-main",ne);var ae=class extends HTMLElement{constructor(){super();c(this,"_isRender",!1);c(this,"rendered",!1);c(this,"_headerElement");c(this,"_groupsWrapperElement");c(this,"_name","");c(this,"_groups",[]);c(this,"groupElements",[]);this._headerElement=m("div",{className:"header-wrapper",style:{textAlign:"center"}}),this._groupsWrapperElement=m("div",{style:{marginTop:".25rem",display:"flex",flexDirection:"column",gap:".5rem",width:"100%"}})}connectedCallback(){!this.groupElements.length&&this._groups.length&&this.createGroupElements(),this.render(),this.updateVisibility()}set options(e){this._name=e.name,this._groups=e.groups,this._isRender=e.render,this.updateGroupElements(),this.render(),this.updateVisibility()}set isRender(e){this._isRender=e,this.updateVisibility()}get isRender(){return this._isRender}updateVisibility(){this._isRender?(this.removeAttribute("hidden"),this.style.display="block",this.style.visibility="visible"):(this.setAttribute("hidden","true"),this.style.display="none",this.style.visibility="hidden")}clear(){this.innerHTML="",this._headerElement.innerHTML="",this._groupsWrapperElement.innerHTML=""}createGroupElements(){this.groupElements=[];for(let e of this._groups){let i=new se;i.options=e,this.groupElements.push(i)}}updateGroupElements(){let e=new Map;for(let r of this.groupElements)e.set(r._key,r);let i=[];for(let r of this._groups){let a=e.get(r.key);a||(a=new se),a.options=r,i.push(a)}this.groupElements=i}render(){!this._groups||this._groups.length===0||this.rendered||(this.dataset.tabId=this._name.toLowerCase(),this.clear(),this._headerElement.append(m("h3",{textContent:this._name,className:F("title-small"),style:{fontSize:"1.25rem"}})),this._groupsWrapperElement.append(...this.groupElements),this.append(this._headerElement,this._groupsWrapperElement),this.rendered=!0)}};customElements.define("setting-section",ae);var se=class extends HTMLElement{constructor(){super();c(this,"_isRender",!1);c(this,"rendered",!1);c(this,"_nameContainerElement");c(this,"_fieldsContainerElement");c(this,"_showName",!0);c(this,"_name","Section");c(this,"_fields",[]);c(this,"_key","");c(this,"fieldElements",[]);this._nameContainerElement=m("div"),this._fieldsContainerElement=m("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"}})}connectedCallback(){!this.fieldElements.length&&this._fields.length&&this.createFieldElements(),this.render(),this.updateVisibility()}set options(e){var i;this._name=e.name,this._fields=e.fields,this._isRender=e.render,this._key=e.key,this._showName=(i=e.showName)!=null?i:!0,this.updateFieldElements(),this.updateVisibility()}set isRender(e){this._isRender=e,this.updateVisibility()}get isRender(){return this._isRender}updateVisibility(){this._isRender?(this.removeAttribute("hidden"),this.style.display="flex",this.style.visibility="visible"):(this.setAttribute("hidden","true"),this.style.display="none",this.style.visibility="hidden")}clear(){this.innerHTML="",this._nameContainerElement.innerHTML="",this._fieldsContainerElement.innerHTML=""}createFieldElements(){var e;this.fieldElements=[];for(let i of this._fields){let r=new le;r.isRender=(e=i.render)!=null?e:!0,r.inputOptions=i.inputOptions,r.label=i.label,r.fieldKey=i.key,i.tooltip&&(r.tooltip=i.tooltip),this.fieldElements.push(r)}}updateFieldElements(){var r,a;let e=new Map;for(let s of this.fieldElements)e.set(s.fieldKey,s);let i=[];for(let s of this._fields){let p=e.get(s.key);p?(p.isRender=(r=s.render)!=null?r:!0,p.inputOptions=s.inputOptions,s.tooltip&&(p.tooltip=s.tooltip)):(p=new le,p.isRender=(a=s.render)!=null?a:!0,p.inputOptions=s.inputOptions,p.label=s.label,p.fieldKey=s.key,s.tooltip&&(p.tooltip=s.tooltip)),i.push(p)}this.fieldElements=i}render(){!this._fields||this._fields.length===0||this.rendered||(this.dataset.groupId=this._name.toLowerCase(),this.clear(),this._name&&this._showName&&(this._nameContainerElement.append(m("h4",{textContent:this._name,className:F("body-small-bold"),style:{fontSize:".8rem",marginLeft:".25rem",lineHeight:"normal"}})),this.append(this._nameContainerElement)),this._fieldsContainerElement.append(...this.fieldElements),this.append(this._fieldsContainerElement),this.rendered=!0)}};customElements.define("setting-group",se);var le=class extends HTMLElement{constructor(){super();c(this,"_isRender");c(this,"rendered");c(this,"_labelContainer");c(this,"_inputElement");c(this,"_tooltipInstance");c(this,"_label");c(this,"_fieldKey","");c(this,"inputOptions");this._isRender=!1,this.rendered=!1,this._label="Section",this._tooltipInstance=null,this.inputOptions=null,this._inputElement=new ie,this._labelContainer=m("div",{className:"label-wrapper",style:{display:"flex",gap:"0.5rem",alignItems:"center"}})}connectedCallback(){this.rendered||this.render(),this.updateVisibility()}disconnectedCallback(){var e;(e=this._tooltipInstance)==null||e.dispose()}set isRender(e){this._isRender=e,this.updateVisibility()}get isRender(){return this._isRender}updateVisibility(){this._isRender?(this.removeAttribute("hidden"),this.style.display="flex",this.style.visibility="visible"):(this.setAttribute("hidden","true"),this.style.display="none",this.style.visibility="hidden")}set tooltip(e){e&&(this._tooltipInstance||(this._tooltipInstance=new Re(e)),this._tooltipInstance.content=e)}clear(){this.innerHTML=""}render(){!this.inputOptions||this.rendered||(this.dataset.fieldId=this._label.toLowerCase(),this._labelContainer.append(m("p",{textContent:this._label,className:F("body-small")})),this._tooltipInstance&&this._labelContainer.append(this._tooltipInstance.elem),this._inputElement.inputOptions=this.inputOptions,this.append(this._labelContainer,this._inputElement),this.rendered=!0)}set label(e){this._label=e,this.rendered&&this.render()}get label(){return this._label}set fieldKey(e){this._fieldKey=e}get fieldKey(){return this._fieldKey}};customElements.define("setting-field",le);var ot=t=>{let o="Invalid URL";try{let e=new URL(t);return["http:","https:"].includes(e.protocol)?{isValid:!0}:{isValid:!1,message:o}}catch(e){return{isValid:!1,message:o}}},ce=(t,o,e)=>{let i=`Enter a number between ${o} and ${e}.`;return typeof t!="number"||Number.isNaN(t)?{isValid:!1,message:i}:t<o||t>e?{isValid:!1,message:i}:{isValid:!0}},$=t=>ce(t,0,512),V=t=>ce(t,0,256),x=t=>ce(t,0,200),pe=t=>ce(t,0,100),po=t=>ce(t,0,10),uo=t=>{if(!t||t.trim()==="")return{isValid:!1,message:"URL cannot be empty."};try{let o=new URL(t);return!o.hostname.endsWith("fonts.googleapis.com")&&!o.hostname.endsWith("fonts.gstatic.com")?{isValid:!1,message:"Hostname is not a Google Fonts domain."}:o.protocol!=="http:"&&o.protocol!=="https:"?{isValid:!1,message:"Protocol must be HTTP or HTTPS."}:!o.pathname.startsWith("/css")&&!o.pathname.startsWith("/earlyaccess")&&!o.hostname.endsWith("fonts.gstatic.com")?{isValid:!1,message:"Path is not a typical Google Fonts CSS path."}:o.hostname.endsWith("fonts.googleapis.com")&&!o.searchParams.has("family")?{isValid:!1,message:"URL does not contain the 'family' parameter."}:{isValid:!0}}catch(o){return{isValid:!1,message:"Invalid URL format."}}};async function mo(t,o="Text copied to clipboard!"){if(navigator.clipboard)try{await navigator.clipboard.writeText(t),console.debug(o),y(o,!1,5e3)}catch(e){console.error("Error copying to clipboard:",e),y(`Error copying to clipboard: ${e instanceof Error?e.message:e}`,!0,5e3)}else console.error("Error copying text (navigator.clipboard not found)"),y("Error copying text (navigator.clipboard not found)",!0,5e3)}async function Ae(t=!1){var o;(!localStorage.getItem(j)||t)&&(await Ar(),(o=window==null?void 0:window.guide)!=null&&o.open?(window.guide.open(),localStorage.setItem(j,"true")):console.error("Guide script loaded, but window.guide is not available."))}async function Ar(){let t="guideScript",o=document.getElementById(t);if(o){console.debug("Guide script already mounted.");return}try{y("Please wait. Guided Tour is loading.",!1,1e3);let e=await O(Ct,Ce);if(o=m("script",{id:t,type:"text/javascript",defer:!0}),!o)return;o.textContent=e,document.body.appendChild(o),console.debug("Mounted Guide script.")}catch(e){console.error("Failed to load guide script:",e),y("Failed to load Guided Tour.",!0)}}var rt={},Fr=(t,o,e)=>new Promise((i,r)=>{let a=indexedDB.open(t,o);a.onerror=s=>{console.error(`IndexedDB error (db: ${t}): ${a.error}`,s),r(a.error)},a.onsuccess=s=>{let p=s.target.result;i(p)},a.onupgradeneeded=s=>{let p=s.target.result;for(let d in e)if(!p.objectStoreNames.contains(d)){let n=p.createObjectStore(d,{keyPath:e[d][0].name});for(let h of e[d])n.createIndex(h.name,h.name,{unique:h.unique})}}}),it=(t,o,e)=>(rt[t]||(rt[t]=Fr(t,o,e)),rt[t]),go=async(t,o,e,i,r=1)=>{let a=await it(t,r,i);return new Promise((s,p)=>{if(!a.objectStoreNames.contains(o)){p(new Error(`Object store "${o}" not found in database "${t}"`));return}let n=a.transaction(o,"readonly").objectStore(o),h;e==="all"?h=n.getAll():h=n.get(e),h.onerror=()=>{console.error(`Error getting element from store "${o}" with key "${e}" in db "${t}": ${h.error}`),p(h.error)},h.onsuccess=b=>s(b.target.result)})},ho=async(t,o,e,i,r=1)=>{let a=await it(t,r,i);return new Promise((s,p)=>{if(!a.objectStoreNames.contains(o)){p(new Error(`Object store "${o}" not found in database "${t}"`));return}let h=a.transaction(o,"readwrite").objectStore(o).add(e);h.onerror=b=>{console.error(`Error adding element to store "${o}" in db "${t}": ${h.error}`,b),p(h.error)},h.onsuccess=()=>{s()}})},fo=async(t,o,e,i,r,a=1)=>{let s=await it(t,a,r);return new Promise((p,d)=>{if(!s.objectStoreNames.contains(o)){d(new Error(`Object store "${o}" not found in database "${t}"`));return}let b=s.transaction(o,"readwrite").objectStore(o).put(i);b.onerror=L=>{console.error(`Error editing element in store "${o}" with key "${e}" in db "${t}": ${b.error}`,L),d(b.error)},b.onsuccess=()=>{p()}})};var nt=1,Fe="images",at={[Fe]:[{name:"uuid",unique:!0}]},yo="image1",bo={uuid:yo,name:"Local Image 1",data:""},vo=(t,o)=>{let e=new CustomEvent("lucid-local-image-change",{detail:{operation:t,payload:o}});window.dispatchEvent(e)},q=async()=>await go(xe,Fe,"all",at,nt),So=async t=>{await fo(xe,Fe,yo,t,at,nt),vo("edit",t)},_o=async()=>{try{await q()?console.debug("Image already Exists."):(await ho(xe,Fe,bo,at,nt),console.debug("Image added successfully."),vo("initialize",bo))}catch(t){console.error("Unexpected error during initialization: ",t)}};var ue=null,He=null,N=new W,Ue=()=>{ue==null||ue()},st=()=>{He==null||He()},Hr=async()=>{let t=m("div",{id:"settings-container"}),o=new ne;return o.isRender=!0,o.options=await wo(),g.subscribe(async e=>{o.options=await wo(e)}),t.appendChild(o),t};async function Co(t){var o;N.isFloating=B.getState().isFloating,N.setContent(await Hr()),B.subscribe(e=>{N.isFloating=e.isFloating},"isFloating"),(o=t!=null?t:document.getElementById("main"))==null||o.append(N),ue=()=>N.open(),He=()=>N.close(),tt(g.getState().position,Ue),g.subscribe(e=>{ue&&tt(e.position,Ue)},"position")}var Eo={floatWin:["Floating Window","Allows settings to float. Drag header to reposition."],winPos:["Window Position","Settings window opens from context menu or nav bar."],bgMode:["Mode","Select background type."],solidColor:["Solid Color","Pick solid background color."],custImg:["Custom Image","Use custom image URL for static background."],custUMVImg:["Custom Image","Use custom image URL for playlist background."],imgSrc:["Image Source","Upload image or use URL for custom background."],custImgUrl:["Custom Image URL","Enter image URL for static background."],custImgInput:["Select Custom Image","Select local image for static background."],custImgLocal:["Select Local Image","Select images for static background."],filterBlur:["Blur","Blur level of image (0-200)."],filterBlurCustom:["Blur (Custom)","Blur level for custom page background (0-200)."],filterBlurNormal:["Blur (Default)","Blur level for default page background (0-200)."],filterBlurNpv:["Blur (NPV)","Blur level for NPV page background (0-200)."],filterExtendedBlur:["Extended background Blur","Blur level of extended page background (0-200)."],filterBright:["Brightness","Brightness of image (0-200)."],filterSat:["Saturation","Saturation of image (0-200)."],dynColor:["Dynamic Color","Dynamic color themes based on artwork."],tonalColor:["Tonal Color","Tonal color scheme for UI."],custColorEnable:["Custom Color","Enable custom color to override theme color."],custColorPicker:["Select Custom Color",'Choose base theme color. Preview: <a href="https://material-foundation.github.io/material-theme-builder/">Material Theme Builder</a>'],gFontsEnable:["Google Fonts","Enable fonts from Google Fonts."],gFontsUrl:["Google Fonts URL","URL of Google Fonts stylesheet."],fontFamily:["Font Family","Font family for UI when Google Fonts disabled."],grainType:["Grain Type","Type of grain effect overlay."],winCtrlHeight:["Control Height","Height of window control buttons on Windows (0-200)."],winPanelGap:["Panel Gap","Gap between main cards."],borderThick:["Thickness","Thickness of interface border (0-10)."],borderColor:["Color","Color of application border."],borderStyle:["Style","Visual style of interface border."],pagesBgStyle:["Style","Background display on pages."],pagesImageStyle:["Image Style","Image on pages. (playlist/album art)"],homeHeaderBg:["Home Header Background","Enable/Disable Home header background."],scrollFullBg:["Scroll Fullscreen Background","Scroll background in fullscreen playlist."],scaleFullBg:["Scale Fullscreen Background","Scale background for fullscreen playlist."],scrollNpvBg:["Scroll Background","Scroll background for Now playing art playlist."],scaleNpvBg:["Scale Background","Scale background for Now playing art playlist."],scrollNormBg:["Scroll Background","Scroll background for normal playlist."],scaleNormBg:["Scale Background","Scale background for normal playlist."],scrollCusBg:["Scroll Background","Scroll background for custom playlist."],scaleCusBg:["Scale Custom Background","Scale background for custom playlist."],rsbViewMode:["View Mode","Normal or compact 'Now Playing' sidebar."],rsbSize:["Compact Sidebar Width","Width of compact 'Now Playing' sidebar (0-512px)."],rsbPos:["Position","Position of compact 'Now Playing' sidebar."],rsbBgBlur:["Blur","Background blur of compact 'Now Playing' view (0-256)."],rsbCustBgEnable:["Custom Background","Enable custom background for Now Playing view."],rsbBgColor:["Color","Background color for 'Now Playing' sidebar."],rsbBgAlpha:["Alpha","Background transparency (alpha) value (0-100)."],rsbBorderAlpha:["Border Alpha","Border transparency (alpha) value (0-100)."],playbarType:["Playbar Type","Default or Compact playbar style."],compactPbHideIcons:["Hide Extra Playbar Icons","Hides extra icons in compact playbar (on hover)."],compactPbBorderRad:["Border Radius","Border Radius of compact playbar in pixels."],normalPbBorderRad:["Border Radius","Border Radius of normal playbar in pixels."],compactPbImgBorderRad:["Art Border Radius","Border Radius of the cover image in compact playbar in pixels."],normalPbImgBorderRad:["Art Border Radius","Border Radius of the cover image in normal playbar in pixels."],compactPbHeight:["Height","Height of compact playbar in pixels."],normalPbHeight:["Height","Height of normal playbar in pixels."],playbarFloat:["Floating","Now playing bar is floating."],pbBackdropBlur:["Backdrop Blur","Blur of normal playbar backdrop (0-256)."],pbBackdropSat:["Backdrop Saturation","Saturation of normal playbar backdrop (0-256)."],pbBackdropBright:["Backdrop Brightness","Brightness of normal playbar backdrop (0-256)."],showChangelog:["Show Changelog","Changelog modal after updates."],lucidTour:["Take a Lucid Tour","Guided walkthrough of Lucid theme features."],exportSettings:["Export Settings","Export settings to clipboard as JSON."],importSettings:["Import Settings","Import settings from JSON."],resetSettings:["Reset All Settings","Reset all settings to default values (irreversible)."],pagesScrollType:["Image Source","Now Playing View art or default playlist art for pages."]};async function wo(t=g.getState(),o=g){var i,r,a,s,p,d;let e=(n,h,b)=>({render:b===void 0?!0:b,inputOptions:h,label:Eo[n][0],tooltip:Eo[n][1],key:n.replace(/([A-Z])/g,"-$1").toLowerCase()});return[{name:"General",render:!0,groups:[{render:!0,name:"Behavior",key:"group-behavior",showName:!1,fields:[e("lucidTour",{type:"button",buttonType:"primary",contents:"Start",onClick:()=>{localStorage.removeItem("lucid-guided-tour"),st(),Ae(!0)}}),e("floatWin",{type:"checkbox",checked:B.getState().isFloating,onChange:n=>{B.setState(h=>u(l({},h),{isFloating:n}))}}),e("winPos",{type:"select",value:t.position,options:[{label:"Context Menu",value:"context-menu"},{label:"Navigation Bar",value:"nav"}],onChange:n=>{o.setPosition(n)}})]}]},{name:"Background",render:!0,groups:[{render:!0,name:"Mode",key:"group-background-mode",fields:[e("bgMode",{type:"select",value:t.background.mode,options:[{label:"Animated",value:"animated"},{label:"Solid Color",value:"solid"},{label:"Static Image",value:"static"}],onChange:n=>{o.setBackgroundMode(n)}})]},{name:"Background",key:"group-bg-background",render:!0,fields:[e("solidColor",{type:"color",value:t.background.options.solid.color.hex,onChange:n=>{o.setSolidBackgroundColor({hex:n})}},t.background.mode==="solid"),e("rsbBgAlpha",{type:"number",value:t.background.options.solid.color.alpha,validator:pe,onChange:n=>{o.setSolidBackgroundColor({alpha:n})}},t.background.mode==="solid"),e("custImg",{type:"checkbox",checked:t.background.options.static.isCustomImage,onChange:n=>{o.setStaticBackgroundOptions({isCustomImage:n})}},t.background.mode==="static"),e("imgSrc",{type:"select",value:t.customImage.type,options:[{label:"Local",value:"local"},{label:"From Url",value:"url"}],onChange:n=>{o.setCustomImageType(n)}},t.background.mode==="static"&&t.background.options.static.isCustomImage),e("custImgUrl",{type:"text",value:(i=t.customImage.options.url.data)!=null?i:"Enter Image URL",validator:ot,onChange:n=>{o.setCustomImageOptions("url",{data:n})}},t.background.mode==="static"&&t.background.options.static.isCustomImage&&t.customImage.type==="url"),e("custImgInput",{type:"image",value:(await q())[0].data,onChange:async n=>{n&&So(u(l({},(await q())[0]),{data:n}))}},t.background.mode==="static"&&t.background.options.static.isCustomImage&&t.customImage.type==="local")]},{render:t.background.mode!=="solid",name:"Filters",key:"group-bg-filters",fields:[e("filterBlur",{type:"number",value:t.background.options.static.filter.blur,onChange:n=>{o.setStaticBackgroundFilter({blur:n})},step:1,validator:x},t.background.mode==="static"),e("filterBright",{type:"number",value:t.background.options.static.filter.brightness,onChange:n=>{o.setStaticBackgroundFilter({brightness:n})},step:1,validator:x},t.background.mode==="static"),e("filterSat",{type:"number",value:t.background.options.static.filter.saturate,onChange:n=>{o.setStaticBackgroundFilter({saturate:n})},step:.1,validator:x},t.background.mode==="static"),e("filterBlur",{type:"number",value:t.background.options.animated.filter.blur,onChange:n=>{o.setAnimatedBackgroundFilter({blur:n})},step:1,validator:x},t.background.mode==="animated"),e("filterBright",{type:"number",value:t.background.options.animated.filter.brightness,onChange:n=>{o.setAnimatedBackgroundFilter({brightness:n})},step:1,validator:x},t.background.mode==="animated"),e("filterSat",{type:"number",value:t.background.options.animated.filter.saturate,onChange:n=>{o.setAnimatedBackgroundFilter({saturate:n})},step:1,validator:x},t.background.mode==="animated")]},{render:!0,name:"Color",key:"group-color",fields:[e("dynColor",{type:"checkbox",checked:t.color.isDynamic,onChange:n=>{o.setDynamicColor(n)}}),e("tonalColor",{type:"checkbox",checked:t.color.isTonal,onChange:n=>{o.setTonalColor(n)}}),e("custColorEnable",{type:"checkbox",checked:t.color.isCustom,onChange:n=>{o.setIsCustomColor(n)}},!t.color.isDynamic),e("custColorPicker",{type:"color",value:t.color.customColor.hex,onChange:n=>{o.setCustomColor({hex:n})}},!t.color.isDynamic&&t.color.isCustom)]}]},{name:"Interface",render:!0,groups:[{render:!0,name:"Font",key:"group-font",fields:[e("gFontsEnable",{type:"checkbox",checked:t.font.isGoogleFonts,onChange:n=>{o.setFont({isGoogleFonts:n})}}),e("gFontsUrl",{type:"text",value:t.font.fontUrl||"",validator:uo,onChange:n=>{o.setFont({fontUrl:n})}},t.font.isGoogleFonts),e("fontFamily",{type:"text",value:t.font.fontFamily||"",onChange:n=>{o.setFont({fontFamily:n})}},!t.font.isGoogleFonts)]},{render:!0,key:"group-grain-effect",name:"Grain Effect",fields:[e("grainType",{type:"select",value:t.grains.type,options:[{label:"Normal",value:"default"},{label:"Starry",value:"starry"},{label:"None",value:"none"}],onChange:n=>{o.setGrainsType(n)}})]},{render:!0,key:"group-window-controls",name:"Window",fields:[e("winPanelGap",{type:"number",step:1,value:t.pages.panelGap,validator:pe,onChange:n=>{o.setPages({panelGap:n})}}),e("winCtrlHeight",{type:"number",step:1,value:t.control.height,validator:x,onChange:n=>{o.setControlHeight(n)}},Me())]},{render:!0,key:"group-border",name:"Border",fields:[e("borderThick",{type:"number",step:1,value:t.border.thickness,validator:po,onChange:n=>{o.setBorder({thickness:n})}}),e("borderStyle",{type:"select",options:[{label:"None",value:"none"},{label:"Solid",value:"solid"},{label:"Dotted",value:"dotted"},{label:"Dashed",value:"dashed"},{label:"Double",value:"double"},{label:"Groove",value:"groove"},{label:"Ridge",value:"ridge"},{label:"Inset",value:"inset"},{label:"Outset",value:"outset"}],onChange:n=>{o.setBorder({style:n})},value:t.border.style}),e("borderColor",{type:"color",value:t.border.color.hex,onChange:n=>{o.setBorderColor({hex:n})}}),e("rsbBorderAlpha",{type:"number",value:t.border.color.alpha,validator:pe,onChange:n=>{o.setBorderColor({alpha:n})}})]},{render:!0,key:"group-now-playing-view",name:"Now Playing View",fields:[e("rsbViewMode",{type:"select",value:t.rightSidebar.mode,options:[{label:"Normal",value:"normal"},{label:"Compact",value:"compact"}],onChange:n=>{o.setRightSidebar({mode:n})}}),e("rsbSize",{type:"number",value:t.rightSidebar.size,validator:$,onChange:n=>{o.setRightSidebar({size:n})}},t.rightSidebar.mode==="compact"),e("rsbPos",{type:"select",value:t.rightSidebar.position,options:[{label:"Top Left",value:"top left"},{label:"Top Right",value:"top right"},{label:"Bottom Left",value:"bottom left"},{label:"Bottom Right",value:"bottom right"}],onChange:n=>{o.setRightSidebar({position:n})}},t.rightSidebar.mode==="compact"),e("rsbBgBlur",{type:"number",value:t.rightSidebar.blur,validator:V,onChange:n=>{o.setRightSidebar({blur:n})}},t.rightSidebar.mode==="compact"),e("rsbCustBgEnable",{type:"checkbox",checked:t.rightSidebar.isCustomBg,onChange:n=>{o.setRightSidebar({isCustomBg:n})}}),e("rsbBgColor",{type:"color",value:t.rightSidebar.color.hex,onChange:n=>{o.setRightSidebarColor({hex:n})}},t.rightSidebar.isCustomBg),e("rsbBgAlpha",{type:"number",value:t.rightSidebar.color.alpha,validator:pe,onChange:n=>{o.setRightSidebarColor({alpha:n})}},t.rightSidebar.isCustomBg)]}]},{name:"Page Settings",render:!0,groups:[{render:!0,key:"group-page-style",name:"Page Styles",fields:[e("homeHeaderBg",{type:"checkbox",checked:t.pages.hideHomeHeader,onChange:n=>{o.setPages({hideHomeHeader:n})}}),e("pagesBgStyle",{type:"select",value:t.pages.style,onChange:n=>{o.setPageStyle(n)},options:[{label:"Default",value:"normal"},{label:"Card",value:"card"},{label:"Compact",value:"compact"},{label:"Compact Card",value:"compact-card"}]}),e("pagesImageStyle",{type:"select",value:t.pages.imageStyle,onChange:n=>{o.setPageImageStyle(n)},options:[{label:"Default",value:"default"},{label:"As Bg",value:"as-bg"},{label:"Hidden",value:"hidden"}]}),e("pagesScrollType",{type:"select",value:t.pages.umv.type,options:[{value:"normal",label:"Default"},{value:"custom",label:"Custom"},{value:"npv",label:"Now Playing Art"}],onChange:n=>{o.setUMV({type:n})}}),e("custUMVImg",{type:"text",validator:ot,value:(r=t.pages.umv.options.custom.url)!=null?r:"Enter a Url",onChange:n=>{o.setUMVOption("custom",{url:n})}},t.pages.umv.type==="custom")]},{key:"group-page-image-filter",name:"Page Background Image Filter",render:!0,fields:[e("filterBlurCustom",{type:"number",validator:x,value:(a=t.pages.umv.options.custom.filter)==null?void 0:a.blur,onChange:n=>{o.setUMVFilter("custom",{blur:n})}},t.pages.umv.type==="custom"),e("filterBlurNormal",{type:"number",validator:x,value:(s=t.pages.umv.options.normal.filter)==null?void 0:s.blur,onChange:n=>{o.setUMVFilter("normal",{blur:n})}},t.pages.umv.type==="normal"),e("filterBlurNpv",{type:"number",validator:x,value:(p=t.pages.umv.options.npv.filter)==null?void 0:p.blur,onChange:n=>{o.setUMVFilter("npv",{blur:n})}},t.pages.umv.type==="npv"),e("filterExtendedBlur",{type:"number",validator:x,value:(d=t.pages.umv.options.expanded.filter)==null?void 0:d.blur,onChange:n=>{o.setUMVFilter("expanded",{blur:n})}})]},{key:"group-page-bg-behavior",name:"Background Behavior",render:!0,fields:[e("scrollCusBg",{type:"checkbox",checked:t.pages.umv.options.custom.isScroll,onChange:n=>{o.setUMVOption("custom",{isScroll:n})}},t.pages.umv.type==="custom"),e("scaleCusBg",{type:"checkbox",checked:t.pages.umv.options.custom.isScaling,onChange:n=>{o.setUMVOption("custom",{isScaling:n})}},t.pages.umv.type==="custom"),e("scrollNormBg",{type:"checkbox",checked:t.pages.umv.options.normal.isScroll,onChange:n=>{o.setUMVOption("normal",{isScroll:n})}},t.pages.umv.type==="normal"),e("scaleNormBg",{type:"checkbox",checked:t.pages.umv.options.normal.isScaling,onChange:n=>{o.setUMVOption("normal",{isScaling:n})}},t.pages.umv.type==="normal"),e("scrollNpvBg",{type:"checkbox",checked:t.pages.umv.options.npv.isScroll,onChange:n=>{o.setUMVOption("npv",{isScroll:n})}},t.pages.umv.type==="npv"),e("scaleNpvBg",{type:"checkbox",checked:t.pages.umv.options.npv.isScaling,onChange:n=>{o.setUMVOption("npv",{isScaling:n})}},t.pages.umv.type==="npv"),e("scrollFullBg",{type:"checkbox",checked:t.pages.umv.options.expanded.isScroll,onChange:n=>{o.setUMVOption("expanded",{isScroll:n})}}),e("scaleFullBg",{type:"checkbox",checked:t.pages.umv.options.expanded.isScaling,onChange:n=>{o.setUMVOption("expanded",{isScaling:n})}})]}]},{name:"Playbar Settings",render:!0,groups:[{render:!0,name:"General",key:"group-playbar-general",showName:!1,fields:[e("playbarType",{type:"select",value:t.playbar.type,onChange:n=>{o.setPlaybar({type:n})},options:[{label:"Default",value:"normal"},{label:"Compact",value:"compact"}]}),e("playbarFloat",{type:"checkbox",checked:t.playbar.isFloating,onChange:n=>{o.setPlaybar({isFloating:n})}})]},{render:t.playbar.type==="compact",name:"Compact Playbar",key:"group-playbar-compact",showName:!0,fields:[e("compactPbHideIcons",{type:"checkbox",checked:t.playbar.hideIcons,onChange:n=>{o.setPlaybar({hideIcons:n})}}),e("compactPbHeight",{type:"number",value:t.playbar.options.compact.height,validator:$,onChange:n=>{o.setPlaybarOptions("compact",{height:n})}}),e("compactPbBorderRad",{type:"number",value:t.playbar.options.compact.borderRadius,validator:$,onChange:n=>{o.setPlaybarOptions("compact",{borderRadius:n})}}),e("pbBackdropBlur",{type:"number",value:t.playbar.options.compact.backdropFilter.blur,validator:V,onChange:n=>{o.setPlaybarFilter("compact",{blur:n})}},t.playbar.isFloating),e("pbBackdropSat",{type:"number",value:t.playbar.options.compact.backdropFilter.saturate,validator:V,onChange:n=>{o.setPlaybarFilter("compact",{saturate:n})}},t.playbar.isFloating),e("pbBackdropBright",{type:"number",value:t.playbar.options.compact.backdropFilter.brightness,validator:V,onChange:n=>{o.setPlaybarFilter("compact",{brightness:n})}},t.playbar.isFloating),e("compactPbImgBorderRad",{type:"number",value:t.playbar.options.compact.imageRadius,validator:$,onChange:n=>{o.setPlaybarOptions("compact",{imageRadius:n})}})]},{render:t.playbar.type==="normal",name:"Normal Playbar",key:"group-playbar-normal",showName:!0,fields:[e("normalPbHeight",{type:"number",value:t.playbar.options.normal.height,validator:$,onChange:n=>{o.setPlaybarOptions("normal",{height:n})}}),e("normalPbBorderRad",{type:"number",value:t.playbar.options.normal.borderRadius,validator:$,onChange:n=>{o.setPlaybarOptions("normal",{borderRadius:n})}}),e("pbBackdropBlur",{type:"number",value:t.playbar.options.normal.backdropFilter.blur,validator:V,onChange:n=>{o.setPlaybarFilter("normal",{blur:n})}},t.playbar.isFloating),e("pbBackdropSat",{type:"number",value:t.playbar.options.normal.backdropFilter.saturate,validator:V,onChange:n=>{o.setPlaybarFilter("normal",{saturate:n})}},t.playbar.isFloating),e("pbBackdropBright",{type:"number",value:t.playbar.options.normal.backdropFilter.brightness,validator:V,onChange:n=>{o.setPlaybarFilter("normal",{brightness:n})}},t.playbar.isFloating),e("normalPbImgBorderRad",{type:"number",value:t.playbar.options.normal.imageRadius,validator:$,onChange:n=>{o.setPlaybarOptions("normal",{imageRadius:n})}})]}]},{name:"Advanced Settings",render:!0,groups:[{render:!0,name:"App Settings",key:"group-application-settings",showName:!1,fields:[e("showChangelog",{type:"checkbox",checked:t.showChangelog,onChange:n=>{o.setChangelog(n)}}),e("exportSettings",{type:"button",buttonType:"primary",contents:"Copy Settings",onClick:()=>{mo(o.exportSettings(),"Settings copied to clipboard!")}}),e("importSettings",{type:"text",value:"",validator:n=>{try{return Ee(JSON.parse(n))?{isValid:!0}:{isValid:!1,message:"Not a valid lucid settings."}}catch(h){return{isValid:!1,message:"Not a valid lucid settings."}}},onChange:n=>{o.importSettings(n)}}),e("resetSettings",{type:"button",buttonType:"danger",contents:"Reset",onClick:()=>{confirm("Are you sure you want to reset all settings to default values? This action cannot be undone.")&&(o.resetState(),window.location.reload())}})]}]}]}function de(t){let o="";return t.blur&&(o+=`blur(${t.blur}px) `),t.brightness&&(o+=`brightness(${t.brightness}%) `),t.contrast&&(o+=`contrast(${t.contrast}%) `),t.grayscale&&(o+=`grayscale(${t.grayscale}) `),t.hueRotate&&(o+=`hue-rotate(${t.hueRotate}) `),t.invert&&(o+=`invert(${t.invert}) `),t.opacity&&(o+=`opacity(${t.opacity}%) `),t.saturate&&(o+=`saturate(${t.saturate||0}%) `),t.sepia&&(o+=`sepia(${t.sepia}) `),o.trim()}var $e=class extends HTMLElement{constructor(){super();c(this,"imgElement");c(this,"transitionDuration","0.3s");c(this,"currentFilters",null);c(this,"src","");this.imgElement=m("div",{style:{width:"100%",height:"100vh",backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",transform:"translate3d(0px,0px,0px)",transition:`background-image ${this.transitionDuration} ease-in-out`}}),this.appendChild(this.imgElement)}set customFilter(e){this.currentFilters=e,this.style.filter=de(e)}setImageSource(e){if(this.src===e)return;this.src=e;let i=new Image;i.onload=()=>{this.performTransition(e)},i.onerror=()=>{console.error("Failed to load image:",e)},i.src=e}performTransition(e){let i=this.imgElement,r=m("div",{style:{width:"100%",height:"100vh",backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",transform:"translate3d(0px,0px,0px)",transition:`opacity ${this.transitionDuration} ease-in-out`,backgroundImage:`url(${e})`,position:"absolute",top:"0",left:"0",opacity:"0"}});this.appendChild(r),r.offsetWidth,r.style.opacity="1",setTimeout(()=>{if(this.src!==e){this.removeChild(r);return}this.removeChild(i),this.imgElement=r,this.currentFilters&&(this.style.filter=de(this.currentFilters)),r.style.position=""},Number.parseFloat(this.transitionDuration)*1e3)}};customElements.define("static-background",$e);var me=$e;var Ve=class extends HTMLElement{constructor(){super();c(this,"imgElements",[]);c(this,"src","");c(this,"transitionDuration","0.3s");this.style.display="block";let e=document.createElement("style");e.textContent=`
#image-1 {
	left: 0%;
	top: -50%;
	z-index: 1;
}
#image-2 {
	animation-direction: reverse;
	top: 20%;
	left: -50%;
	z-index: 1;
}
#image-3 {
	animation-direction: reverse;
	right: -50%;
	top: -20%;
	width: 200%;
	z-index: 0;
}
@keyframes animBg {
	0% {
		transform: rotate(0turn) translate3d(0px,0px,0px);
	}
	to {
		transform: rotate(1turn) translate3d(0px,0px,0px);
	}
}`,this.appendChild(e);for(let i=0;i<3;i++){let r=document.createElement("div");r.id=`image-${i+1}`,r.classList.add("image",`${i+1}`),Object.assign(r.style,{width:"100ch",height:"100ch",backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",animation:"animBg 30s linear infinite",willChange:"contents",position:"absolute",transition:`opacity ${this.transitionDuration} ease-in-out`,opacity:"0"}),this.imgElements.push(r),this.appendChild(r),r.offsetWidth,r.style.opacity="1"}}get customFilter(){return this.customFilter}set customFilter(e){this.style.filter=de(e)}setImageSource(e){this.src!==e&&(this.src=e,this.performTransition(e))}performTransition(e){for(let i of this.imgElements){let r=new Image;r.onload=()=>{i.style.backgroundImage=`url(${e})`},r.onerror=()=>{console.error("Failed to load image:",e)},r.src=e}}};customElements.define("animated-background",Ve);var ge=Ve;var Ne=class extends HTMLElement{constructor(){super();c(this,"backgroundElement",null);c(this,"options",null);c(this,"currentMode","static");Object.assign(this.style,{width:"100%",height:"100vh",display:"block",position:"fixed",inset:"0px",backgroundColor:"var(--clr-surface)"}),this.render()}set image(e){console.log(e,this.backgroundElement,this.currentMode),(this.backgroundElement instanceof me||this.backgroundElement instanceof ge)&&this.currentMode!=="solid"&&(console.log(e),this.backgroundElement.setImageSource(e))}get mode(){return this.currentMode}set mode(e){this.currentMode!==e&&(this.currentMode=e,this.setAttribute("mode",e),this.render())}setOptions(e){this.options=e,this.updateOptions()}getOptions(){return this.options}updateOptions(){if(!(!this.options||!this.backgroundElement))switch(this.currentMode){case"static":this.backgroundElement instanceof me&&(this.backgroundElement.customFilter=this.options.static.filter||{});break;case"solid":this.backgroundElement instanceof HTMLDivElement&&this.backgroundElement.classList.contains("solid")&&Object.assign(this.backgroundElement.style,{backgroundColor:this.options.solid.color.hex+A(this.options.solid.color.alpha||1)||"var(--clr-surface, #101010)"});break;case"animated":this.backgroundElement instanceof ge&&(this.backgroundElement.customFilter=this.options.animated.filter||{});break}}render(){let e=this.currentMode,i=this.image,r=this.querySelector("#bg-wrapper");switch(r||(r=m("div",{id:"bg-wrapper",style:{width:"100%",height:"100%"},innerHTML:""}),r.setAttribute("mode",this.currentMode),this.appendChild(r)),e){case"static":{let a;this.backgroundElement instanceof me?a=this.backgroundElement:(a=new me,a.setImageSource(i),this.backgroundElement=a),r.appendChild(a);break}case"solid":{let a;this.backgroundElement instanceof HTMLDivElement&&this.backgroundElement.classList.contains("solid")?a=this.backgroundElement:(a=m("div",{className:"solid background"}),Object.assign(a.style,{width:"100%",height:"100vh"}),this.backgroundElement=a),r.appendChild(a);break}case"animated":{let a;this.backgroundElement instanceof ge?a=this.backgroundElement:(a=new ge,a.setImageSource(i),this.backgroundElement=a),r.appendChild(a);break}}this.updateOptions()}};customElements.define("lucid-background-container",Ne);var ko=Ne;var T=null,he=null;function lt(t){var o,e,i,r;T&&(T.image=(r=(i=(e=(o=t.detail)==null?void 0:o.payload)==null?void 0:e.data)!=null?i:w.getState().url)!=null?r:"")}function xo(){if(T)return;T=new ko;let t=Ur(),o=a=>{T&&(T.image=a)},e=()=>{he||(he=w.subscribe(a=>{!g.getState().background.options.static.isCustomImage&&T&&o(a.url||"")}))},i=()=>{he&&(he(),he=null),window.removeEventListener("lucid-local-image-change",lt)},r=async(a=g.getState())=>{var d;if(!T)return;let{background:s,customImage:p}=a;if(T.mode=s.mode,T.setOptions(s.options),s.options.static.isCustomImage){if(i(),p.type==="url")o(p.options.url.data);else if(p.type==="local")try{let n=await q();o(((d=n==null?void 0:n[0])==null?void 0:d.data)||w.getState().url||""),window.addEventListener("lucid-local-image-change",lt)}catch(n){console.error("Error setting local image.")}}else e(),window.removeEventListener("lucid-local-image-change",lt),o(w.getState().url||"")};r(),g.subscribe(a=>r(a),"background"),g.subscribe(a=>r(a),"customImage"),t.appendChild(T)}function Ur(){let t=document.getElementById("lucid-bg");return t||(t=m("div"),t.id="lucid-bg",Bt("main").prepend(t)),t}function Io(t=g.getState().rightSidebar){t.position?document.body.setAttribute("npv-position",t.position):document.body.removeAttribute("npv-position"),t.mode?document.body.setAttribute("npv-mode",t.mode):document.body.removeAttribute("npv-mode"),document.body.style.setProperty("--npv-blur",`${t.blur}px`),t.isCustomBg?document.body.style.setProperty("--npv-bg-color",`${t.color.hex}${A(t.color.alpha)}`):document.body.style.removeProperty("--npv-bg-color");function o(e){document.body.style.setProperty("--npv-size",`${e}px`)}o(t.size)}function To(){Io(),g.subscribe(t=>{Io(t.rightSidebar)},"rightSidebar")}var De=null;function Lo(t=g.getState().grains){let o=t.type;De!==o&&(De&&document.body.classList.remove(`grain-${De}`),o?(document.body.setAttribute("grain-type",o),document.body.classList.add(`grain-${o}`)):document.body.removeAttribute("grain-type"),De=o)}function Bo(){Lo(),g.subscribe(t=>{Lo(t.grains)},"grains")}function $r(t,o){let e=t.split(".").map(Number),i=o.split(".").map(Number),r=Math.max(e.length,i.length);for(let a=0;a<r;a++){let s=e[a]||0,p=i[a]||0;if(s>p)return 1;if(s<p)return-1}return 0}var fe=class extends HTMLElement{constructor(e){super();c(this,"_data",null);c(this,"_currentVersion");c(this,"hasUpdate",!1);this._currentVersion=Q,e&&(this._data=e,this.hasUpdate=this.checkForUpdate())}connectedCallback(){S("lucid-changelog").textContent=".changelog-entry,.update-available-header {  padding: 1rem 1rem;  background-color: rgba(var(--clr-on-secondary-rgb), 0.5);  color: var(--clr-secondary);  margin-bottom: 0.5rem;  border-radius: 0.5rem;}.update-available-header {  text-align: center;  font-size: 1.8em;  color: var(--clr-primary);}.changelog-entry > p {  margin-bottom: 0.5rem;}.changes-wrapper {  display: flex;  flex-wrap: wrap;  gap: 0.5rem;}.changelog-entry,.update-available-header,.change-card {  border: var(--border-thickness, 1px) var(--border-style, solid)    var(--border-color, var(--clr-surface-5, #1c1b1e));}.change-card {  flex-grow: 1;  padding: 10px;  border-radius: 0.75rem;  min-width: 10em;}.change-card:nth-child(2n) {  background-color: rgba(var(--clr-on-primary-rgb), 0.7);  color: var(--clr-primary);}.change-card:nth-child(2n + 1) {  background-color: rgba(var(--clr-on-secondary-rgb), 0.7);  color: var(--clr-secondary);}.change-card:nth-child(2n + 3) {  background-color: rgba(var(--clr-on-tertiary-rgb), 0.7);  color: var(--clr-tertiary);}.change-card li {  list-style: disc;  margin-left: 2rem;}.change-card li:marker {  right: 4px;}",this.render()}checkForUpdate(){if(this._data&&this._data.length>0&&this._currentVersion){let e=this._data[0].version;return $r(e,this._currentVersion)>0}return!1}render(){if(this.innerHTML="",!this._data){this.innerHTML="<p>Error loading changelog data.</p>",console.error("Invalid changelog data format.");return}if(this._data.length<1){this.innerHTML="<p>No changelog entries available.</p>",console.warn("No elements present to show changelog.");return}let e=this._data.map(a=>{let s="";for(let d in a.changes)if(Object.prototype.hasOwnProperty.call(a.changes,d)){let n=a.changes[d];if(n&&n.length>0){let h=n.map(b=>`<li>${b}</li>`).join("");s+=`
                    <div class="change-card">
                      <h3 class='encore-text encore-text-small-bold'>${d}</h3>
                      <ul>${h}</ul>
                    </div>
                  `}}let p=a.desc?`<p>${a.desc}</p>`:"";return`
              <div class="changelog-entry">
                <h2>${a.version} - ${a.date}</h2>
                ${p}
                <div class="changes-wrapper">
                  ${s}
                </div>
              </div>
            `}).join(""),i="";this.hasUpdate&&(i='<h1 class="update-available-header">Update Available</h1>');let r=document.createElement("div");r.innerHTML=`
        ${i}
        <div class="changelog-entries-container">${e}</div>`,this.appendChild(r)}updateData(e){this._data=e,this.hasUpdate=this.checkForUpdate(),this.render()}};customElements.define("changelog-component",fe);async function Vr(){try{let t=await O(xt,ke,21600);return JSON.parse(t)}catch(t){return console.error("Error fetching changelog.",t),[]}}async function Mo(t=document.body){if(!g.getState().showChangelog)return;let o=await Vr();if(typeof o=="object"&&o.length<1){console.error("Changelog data not found.");return}let e=new G;e.setHeader("Lucid Changelog");let i=new fe(o);!(localStorage.getItem(D)===Q)||i.hasUpdate?(e.setContent(i),t.appendChild(e),e.open(),localStorage.setItem(D,Q)):console.debug("Changelog already shown for this version.")}var Po=()=>{var t;window.lucid={config:()=>g.getState(),reset:()=>{g.resetState()},store:g,version:(t=localStorage.getItem(D))!=null?t:"2.0.0",settings:{openSettings:Ue,closeSettings:st,settingModal:N}}};var Nr=()=>{let t=new $t;Po(),_o();function o(){let r=document.getElementById("main");r?r.append(t):document.body.appendChild(t)}function e(){let r=()=>{let a=g.getState().border,s=S("lucid-border");s.textContent=":root{",s.textContent+=`--border-color:${a.color.hex}${A(a.color.alpha)};`,a.style&&(s.textContent+=`--border-style:${a.style};`),a.thickness&&(s.textContent+=`--border-thickness:${a.thickness}px;`),s.textContent+="}"};r(),g.subscribe(r,"border")}function i(){var s,p;P([".Root__now-playing-bar",".Root__globalNav"],([d,n])=>{document.body.style.setProperty("--umv-offset",`${((d==null?void 0:d.clientHeight)||80)+((n==null?void 0:n.clientHeight)||64)}px`)});let r=new te,a=(s=document.querySelector(".under-main-view"))==null?void 0:s.parentElement;a?a.prepend(r):(p=document.querySelector(".main-view-container"))==null||p.prepend(r)}setTimeout(i,500),o(),e(),xo(),Ut(),Dt(),Bo(),Ze(),Yt(),Qt(),eo(),To(),Xe(),g.subscribe(r=>{Xe(r.color)},"color"),Co(t),Ae(),Mo()};console.time("Main fn start");Nr();console.timeEnd("Main fn start");})();
})();